     1  000000             CHIP		SN8P2501D
     2  000000             //{{SONIX_CODE_OPTION
     3  000000             	.Code_Option	Noise_Filter	Enable
     4  000000             	.Code_Option	Reset_Pin	P11
     5  000000             	.Code_Option	Watch_Dog	Disable
     6  000000             	.Code_Option	High_Clk	IHRC_RTC	;
     7  000000             	.Code_Option	Fcpu		#3     ; Fcpu = Fosc/8
     8  000000             	.Code_Option	Security	Enable
     9  000000             	.Code_Option	LVD		LVD_L		;
    10  000000             //}}SONIX_CODE_OPTION
    11  000000             
    12  E 0000002F         	END_RAM_ADDR	EQU	0X2F
    13  E 000000A1         	EER_ADD			EQU	0XA1	;10100001B
    14  E 000000A0         	EEW_ADD			EQU	0XA0	;10100000B
    15  E 00000030         	RAM_COUNT		EQU	48
    16  E 00000034         	TM_DATA_H		EQU	0X34	;ADDR OF THE TEMPEATURE	OF TM
    17  E 00000000         	TM_DATA_L		EQU	0X00
    18  E 00000078         	TIME_GAP		EQU	0X78	;0X78
    19  E 00000001         	T0_TDR			EQU	0X01
    20  E 0000003D         	TMR_ADD 		EQU	0X3D
    21  E 0000003C         	TMW_ADD			EQU	0X3C
    22  E 0000001F         	MAX_MEMH		EQU	0X1F
    23  E 000000F0         	MAX_MEML		EQU	0XF0
    24  E 0000001F         	LAST_TIME_EE_ADD_H EQU 0X1F
    25  E 000000FE         	LAST_TIME_EE_ADD_L EQU 0XFE
    26  E 0000001F         	LIVE_TIME_ADD_H		EQU	0X1F
    27  E 000000FC         	LIVE_TIME_ADD_L		EQU	0XFC
    28  E 00000001         	DEFAULT_FRONT_TIME_DELAY	EQU	0X01
    29  E 00000001         	DEFAULT_TIME_GAP	EQU	0X01
    30  E 00000030         	TM_INITIAL_TIME_ADD_H	EQU 0X30
    31  E 00000000         	TM_INITIAL_TIME_ADD_L	EQU 0X00
    32  E 00000031         	TM_TIME_H		EQU	0X31
    33  E 00000000         	TM_TIME_L		EQU	0X00
    34  E 0000001F         	EE_DELAY_ADD_H	EQU	0X1F
    35  E 000000F8         	EE_GAP_ADD_L	EQU	0XF8
    36  E 0000001F         	EE_INITIAL_TIME_ADD_H	EQU	0X1F
    37  E 000000FA         	EE_INITIAL_TIME_ADD_L	EQU	0XFA
    38  E 00000001         	WRITE_FLAG_H	EQU 0X01
    39  E 00000000         	WRITE_FLAG_L	EQU	0X00
    40  E 00000002         	DEFAULT_GAP_TIME_FLAGH EQU 0X02
    41  E 00000000         	DEFAULT_GAP_TIME_FLAGL EQU	0X00
    42  000000             .DATA
    43  000000             			ORG	0H
    44  0000 D             	DELAYTIME1	DS	1
    45  0001 D             	DELAYTIME2	DS	1
    46  0002 D             	TIMEOUT		DS	1
    47  0003 D             	TLC0		DS	1
    48  0004 D             	TLC1		DS	1
    49  0005 D             	TLC2		DS	1
    50  0006 D             	FLAG1		DS	1
    51  0007 D             	FLAG2		DS	1
    52  0008 D             	TIMEH		DS	1
    53  0009 D             	TIMEG		DS	1
    54  000A D             	DATA_IN		DS	1
    55  000B D             	DATA_OUT	DS	1
    56  000C D             	DATAH		DS	1
    57  000D D             	DATAL		DS	1
    58  000E D             	ADDRESSH	DS	1
    59  000F D             	ADDRESSL	DS	1
    60  0010 D             	CRCT1		DS	1
    61  0011 D             	CRCT2		DS	1
    62  0012 D             	COUNT		DS	1
    63  0013 D             	MAC_H		DS	1
    64  0014 D             	MAC_L		DS	1
    65  0015 D             	FRONT_DELAY	DS	1
    66  0016 D             	TIME_DELAY_GAP	DS	1
    67  0017 D             	STARTADDRH		DS	1
    68  0018 D             	STARTADDRL		DS	1
    69  0019 D             	INITIAL_TIMEH	DS	1
    70  001A D             	INITIAL_TIMEL	DS	1
    71  00001B             ;**************BIT_VARIABLES_DEFINNITIONS*******
    72  E 00000006         	READTM_FLAG	EQU	FLAG1.0
    73  E 00030006         	TIME_FLAG	EQU	FLAG1.3
    74  E 00010006         	RESET_FLAG	EQU	FLAG1.1
    75  E 00020006         	TM_EE_FLAG	EQU FLAG1.2
    76  E 00040006         	DEFAULT_GAP_FLAG	EQU	FLAG1.4
    77  E 00050006         	FILLOUT_FLAG	EQU	FLAG1.5
    78  E 00060006         	I2CERROR_FLAG	EQU	FLAG1.6
    79  E 00070006         	ASK_FLAG	EQU	FLAG1.7
    80  E 00010007         	READ_LED_FLAG	EQU	FLAG2.1
    81  E 00020007         	NOT_UPLOAD_FLAG	EQU	FLAG2.2
    82  E 00030007         	HAVE_UPLOAD_FLAG EQU FLAG2.3
    83  E 00040007         	NOT_QUICK_MODE_FLAG EQU FLAG2.4
    84  E 00050007         	TM_I2C_EEROR	EQU FLAG2.5
    85  E 00060007         	BLE_FLAG		EQU FLAG2.6
    86  E 000200D2         	CLED_IO			EQU	P2.2
    87  E 000100D2         	SDATA_IO		EQU	P2.1
    88  E 000000D2         	SCL_IO			EQU	P2.0
    89  E 000300D2         	S_TM_EE_IO		EQU	P2.3
    90  E 000400D2         	BLEF	EQU	P2.4
    91  E 000500D2         	SDA_IO			EQU	P2.5
    92  E 000400D5         	VTM_IO			EQU	P5.4
    93  E 000000D0         	VSR_IO			EQU	P0.0
    94  E 000200C2         	CLED_CONT		EQU	P2M.2
    95  E 000100C2         	SDATA_CONT		EQU	P2M.1
    96  E 000000C2         	SCL_CONT		EQU	P2M.0
    97  E 000300C2         	S_TM_EE_CONT	EQU	P2M.3
    98  E 000500C2         	SDA_CONT		EQU	P2M.5
    99  E 000400C5         	VTM_CONT		EQU	P5M.4
   100  E 000000B8         	VSR_CONT		EQU	P0M.0
   101  00001B             ;***************************************
   102  E 000100D1         	VDDF			EQU	P1.1
   103  E 000000D1         	S_VDD_VCC_IO		EQU	P1.0
   104  E 000000C1         	S_VDD_VCC_CONT		EQU	P1M.0
   105  00001B             ;*************CODE_SECTION**********************	
   106  000000             .CODE
   107  000000             
   108  000000             		ORG	0
   109  000000   8030(2)  	JMP		START
   110  000008             		ORG	8H
   111  000008   8009(2)  	JMP		INT_SERVICE
   112  000009             INT_SERVICE:
   113  000009             ;KEEP ACC AND PFLAG
   114  000009   0400(1)  	PUSH
   115  00000A             ;T0 INTERRUPT
   116  00000A             JUST_T0:
   117  00000A   74C9(1+S)  	B0BTS0	FT0IEN
   118  00000B   7CC8(1+S)  	B0BTS1	FT0IRQ
   119  00000C   8025(2)  	JMP		JUST_TC0
   120  00000D   64C8(1)  	B0BCLR	FT0IRQ
   121  00000E             ;T0 INTERRUPT SERVISE PROGRESS
   122  00000E   71D1(1+S)  	B0BTS0	VDDF
   123  00000F   4A07(1)  	BSET 	NOT_UPLOAD_FLAG
   124  000010   71D1(1+S)  	B0BTS0	VDDF
   125  000011   4307(1)  	BCLR    HAVE_UPLOAD_FLAG
   126  000012             ;///////////////////////////////
   127  000012   5B07(1+S)  	BTS1	HAVE_UPLOAD_FLAG
   128  000013   8016(2)  	JMP		$+3
   129  000014   79D1(1+S)  	B0BTS1	VDDF
   130  000015   4C07(1)  	BSET	NOT_QUICK_MODE_FLAG
   131  000016   79D1(1+S)  	B0BTS1	VDDF
   132  000017   4B07(1)  	BSET    HAVE_UPLOAD_FLAG
   133  000018             ;//////////////////////////////////
   134  000018   1608(1+S)  	INCMS	TIMEH ;TIMEH=TIMEH+1,
   135  000019   2D78(1)  	MOV		A,#TIME_GAP
   136  00001A   0708(1+S)  	CMPRS	A,TIMEH
   137  00001B   802E(2)  	JMP		EXIT_INT
   138  00001C   2B08(1)  	CLR		TIMEH
   139  00001D   4B06(1)  	BSET	TIME_FLAG
   140  00001E   1609(1+S)  	INCMS	TIMEG
   141  00001F   1E16(1)  	MOV		A,TIME_DELAY_GAP
   142  000020   0709(1+S)  	CMPRS	A,TIMEG
   143  000021   802E(2)  	JMP		EXIT_INT
   144  000022   2B09(1)  	CLR		TIMEG
   145  000023   4806(1)  	BSET	READTM_FLAG
   146  000024   802E(2)  	JMP		EXIT_INT
   147  000025             JUST_TC0:
   148  000025   75C9(1+S)  	B0BTS0	FTC0IEN
   149  000026   7DC8(1+S)  	B0BTS1	FTC0IRQ
   150  000027   802A(2)  	JMP		JUST_INT0
   151  000028   65C8(1)  	B0BCLR	FTC0IRQ
   152  000029             ;TC0 INTERRUPT SERVICE PROGRESS
   153  000029   802E(2)  	JMP		EXIT_INT
   154  00002A             JUST_INT0:
   155  00002A   70C9(1+S)  	B0BTS0	FP00IEN
   156  00002B   78C8(1+S)  	B0BTS1	FP00IRQ
   157  00002C   802E(2)  	JMP EXIT_INT
   158  00002D   60C8(1)  	B0BCLR	FP00IRQ
   159  00002E             ;INT0 INTERRUPT SERVISE PROGRESS
   160  00002E             EXIT_INT:
   161  00002E   0500(1)  	POP
   162  00002F   0F00(2)  	RETI
   163  000030             ;*********************************************************
   164  000030             ;***********************STARRT**********************
   165  000030             START:
   166  000030   2D7F(1)  	MOV		A,#07FH
   167  000031   2FDF(1)  	B0MOV		STKP,A		;DISABLE GLOBAL INTERRUPT
   168  000032   2B86(1)  	CLR		PFLAG
   169  000033   2D00(1)  	MOV		A,#00H
   170  000034   2FCA(1)  	B0MOV		OSCM,A
   171  000035   2D5A(1)  	MOV		A,#0X5A
   172  000036   2FCC(1)  	B0MOV		WDTR,A	
   173  000037   C18B(2)  	CALL		CLRRAM
   174  000038             STATE_INITIAL:
   175  000038   C324(2)  	CALL		SYS_INIT_FUN
   176  000039   67DF(1)  	B0BCLR		FGIE
   177  00003A             ;******************************************
   178  00003A   2D01(1)  	MOV		A,#DEFAULT_FRONT_TIME_DELAY
   179  00003B   1F15(1)  	MOV		FRONT_DELAY,A
   180  00003C   2D01(1)  	MOV		A,#DEFAULT_TIME_GAP
   181  00003D   1F16(1)  	MOV		TIME_DELAY_GAP,A
   182  00003E             ;////////////////////////////////
   183  00003E   5607(1+S)  	BTS0		BLE_FLAG
   184  00003F   805C(2)  	JMP			GET_INITIAL_DATA_FROM_EE
   185  000040             GET_TIME_INITIAL_TM:
   186  000040   6BD2(1)  	B0BSET	S_TM_EE_IO
   187  000041             ;Get initial time from tm
   188  000041   2D30(1)  	MOV		A,#TM_INITIAL_TIME_ADD_H
   189  000042   1F13(1)  	MOV		MAC_H,A
   190  000043   2D00(1)  	MOV		A,#TM_INITIAL_TIME_ADD_L
   191  000044   1F14(1)  	MOV		MAC_L,A
   192  000045   C1F7(2)  	CALL	GET_DATA_FROM_TM_FUN
   193  000046   1E0C(1)  	MOV		A,DATAH
   194  000047   0600(1+S)  	CMPRS	A,#0X00
   195  000048   1F19(1)  	MOV		INITIAL_TIMEH,A
   196  000049   1E0D(1)  	MOV		A,DATAL
   197  00004A   0600(1+S)  	CMPRS	A,#0X00
   198  00004B   1F1A(1)  	MOV		INITIAL_TIMEL,A
   199  00004C   C300(2)  	CALL	DELAY_SHORT
   200  00004D             ;GET TIME DELAY AND GAP FROM TM
   201  00004D   2D31(1)  	MOV		A,#TM_TIME_H
   202  00004E   1F13(1)  	MOV		MAC_H,A
   203  00004F   2D00(1)  	MOV		A,#TM_TIME_L
   204  000050   1F14(1)  	MOV		MAC_L,A
   205  000051   C1F7(2)  	CALL	GET_DATA_FROM_TM_FUN
   206  000052             ;the 2bit in front of DATAH is useness
   207  000052   2D3F(1)  	MOV		A,#0X3F
   208  000053   290C(1)  	AND		DATAH,A
   209  000054   1E0C(1)  	MOV			A,DATAH
   210  000055   0600(1+S)  	CMPRS		A,#0X00
   211  000056   1F15(1)  	MOV			FRONT_DELAY,A
   212  000057   1E0D(1)  	MOV			A,DATAL
   213  000058   0600(1+S)  	CMPRS		A,#0X00
   214  000059   1F16(1)  	MOV			TIME_DELAY_GAP,A		
   215  00005A   63D2(1)  	B0BCLR		S_TM_EE_IO
   216  00005B   C306(2)  	CALL		DELAY_LONG
   217  00005C             ;*******************************************
   218  00005C             GET_INITIAL_DATA_FROM_EE:
   219  00005C             ;*******************************************
   220  00005C   2D1F(1)  	MOV			A,#LAST_TIME_EE_ADD_H
   221  00005D   1F13(1)  	MOV			MAC_H,A
   222  00005E   2DFE(1)  	MOV			A,#LAST_TIME_EE_ADD_L
   223  00005F   1F14(1)  	MOV			MAC_L,A
   224  000060   5106(1+S)  	BTS0		RESET_FLAG
   225  000061   80C7(2)  	JMP			RESET_EEPROM
   226  000062   C248(2)  	CALL		GET_DATA_FROM_EE_FUN
   227  000063   1E0F(1)  	MOV			A,ADDRESSL
   228  000064   1F18(1)  	MOV			STARTADDRL,A
   229  000065   1E0E(1)  	MOV			A,ADDRESSH
   230  000066   1F17(1)  	MOV			STARTADDRH,A
   231  000067   1E0E(1)  	MOV			A,ADDRESSH
   232  000068   06FF(1+S)  	CMPRS		A,#0XFF
   233  000069   806C(2)  	JMP			$+3
   234  00006A   2B17(1)  	CLR			STARTADDRH
   235  00006B   2B18(1)  	CLR			STARTADDRL
   236  00006C   C306(2)  	CALL		DELAY_LONG
   237  00006D   2D1F(1)  	MOV			A,#LIVE_TIME_ADD_H
   238  00006E   1F13(1)  	MOV			MAC_H,A
   239  00006F   2DFC(1)  	MOV			A,#LIVE_TIME_ADD_L
   240  000070   1F14(1)  	MOV			MAC_L,A
   241  000071   C248(2)  	CALL		GET_DATA_FROM_EE_FUN
   242  000072             ;;;;;;;;;;;;;;LAST READ TM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   243  000072   6BD2(1)  	B0BSET		S_TM_EE_IO
   244  000073   60D0(1)  	B0BCLR		VSR_IO
   245  000074   2D34(1)  	MOV			A,#TM_DATA_H
   246  000075   1F13(1)  	MOV			MAC_H,A
   247  000076   2D00(1)  	MOV			A,#TM_DATA_L
   248  000077   1F14(1)  	MOV			MAC_L,A
   249  000078   C1F7(2)  	CALL		GET_DATA_FROM_TM_FUN
   250  000079   64D5(1)  	B0BCLR		VTM_IO
   251  00007A   C300(2)  	CALL		DELAY_SHORT
   252  00007B   63D2(1)  	B0BCLR		S_TM_EE_IO
   253  00007C   64C5(1)  	B0BCLR		VTM_CONT
   254  00007D             ;////////////////////READ BLE INITIAL TIME /////////////////
   255  00007D   5E07(1+S)  	BTS1		BLE_FLAG
   256  00007E   80AC(2)  	JMP			WRITE_INITIAL_DATA_TO_EE
   257  00007F             GET_INITIAL_TIME_FROM_EE:
   258  00007F   C300(2)  	CALL		DELAY_SHORT
   259  000080   2D1F(1)  	MOV		A,#EE_INITIAL_TIME_ADD_H
   260  000081   1F13(1)  	MOV		MAC_H,A
   261  000082   2DFA(1)  	MOV		A,#EE_INITIAL_TIME_ADD_L
   262  000083   1F14(1)  	MOV		MAC_L,A
   263  000084   C248(2)  	CALL		GET_DATA_FROM_EE_FUN
   264  000085   1E0E(1)  	MOV		A,ADDRESSH
   265  000086   1F19(1)  	MOV		INITIAL_TIMEH,A
   266  000087   1E0F(1)  	MOV		A,ADDRESSL
   267  000088   1F1A(1)  	MOV		INITIAL_TIMEL,A
   268  000089   C306(2)  	CALL	DELAY_LONG
   269  00008A   2D1F(1)  	MOV		A,#EE_DELAY_ADD_H
   270  00008B   1F13(1)  	MOV		MAC_H,A
   271  00008C   2DF8(1)  	MOV		A,#EE_GAP_ADD_L
   272  00008D   1F14(1)  	MOV		MAC_L,A
   273  00008E   C248(2)  	CALL		GET_DATA_FROM_EE_FUN
   274  00008F   1E0E(1)  	MOV		A,ADDRESSH
   275  000090   1F15(1)  	MOV		FRONT_DELAY,A
   276  000091   1E0F(1)  	MOV		A,ADDRESSL
   277  000092   1F16(1)  	MOV		TIME_DELAY_GAP,A
   278  000093   C306(2)  	CALL	DELAY_LONG
   279  000094             ;/////////////////WRITE TO TM//////////////////////////////
   280  000094             WRITE_INITIAL_DATA_TO_TM:
   281  000094   6BD2(1)  	B0BSET	S_TM_EE_IO
   282  000095             ;PUT initial time TO tm
   283  000095   2D30(1)  	MOV		A,#TM_INITIAL_TIME_ADD_H
   284  000096   1F13(1)  	MOV		MAC_H,A
   285  000097   2D00(1)  	MOV		A,#TM_INITIAL_TIME_ADD_L
   286  000098   1F14(1)  	MOV		MAC_L,A
   287  000099   1E19(1)  	MOV		A,INITIAL_TIMEH
   288  00009A   1F0C(1)  	MOV		DATAH,A
   289  00009B   1E1A(1)  	MOV		A,INITIAL_TIMEL
   290  00009C   1F0D(1)  	MOV		DATAL,A
   291  00009D   C1B5(2)  	CALL	PUT_DATA_INTO_TM_FUN
   292  00009E             ;PUT TIME DELAY AND GAP TO TM
   293  00009E   2D31(1)  	MOV		A,#TM_TIME_H
   294  00009F   1F13(1)  	MOV		MAC_H,A
   295  0000A0   2D00(1)  	MOV		A,#TM_TIME_L
   296  0000A1   1F14(1)  	MOV		MAC_L,A
   297  0000A2             ;the 2bit in front of DATAH is useness
   298  0000A2   2D3F(1)  	MOV		A,#0X3F
   299  0000A3   2815(1)  	AND		A,FRONT_DELAY
   300  0000A4   1F0C(1)  	MOV		DATAH,A
   301  0000A5   1E16(1)  	MOV		A,TIME_DELAY_GAP
   302  0000A6   1F0D(1)  	MOV		DATAL,A	
   303  0000A7   C1B5(2)  	CALL	PUT_DATA_INTO_TM_FUN
   304  0000A8             ;the 2bit in front of DATAH is useness
   305  0000A8   63D2(1)  	B0BCLR		S_TM_EE_IO
   306  0000A9   C306(2)  	CALL		DELAY_LONG
   307  0000AA             ;///////////////////////////////
   308  0000AA   5607(1+S)  	BTS0	BLE_FLAG
   309  0000AB   80C1(2)  	JMP		SET_WRITE_EE_START_ADD
   310  0000AC             ;/////////////////WRITE TO EE//////////////////////////////
   311  0000AC             WRITE_INITIAL_DATA_TO_EE:
   312  0000AC             ;///////////INITIAL TIME/////////////////////
   313  0000AC   C300(2)  	CALL		DELAY_SHORT
   314  0000AD   2D1F(1)  	MOV		A,#EE_INITIAL_TIME_ADD_H
   315  0000AE   1F13(1)  	MOV		MAC_H,A
   316  0000AF   2DFA(1)  	MOV		A,#EE_INITIAL_TIME_ADD_L
   317  0000B0   1F14(1)  	MOV		MAC_L,A
   318  0000B1   1E19(1)  	MOV		A,INITIAL_TIMEH
   319  0000B2   1F0C(1)  	MOV		DATAH,A
   320  0000B3   1E1A(1)  	MOV		A,INITIAL_TIMEL
   321  0000B4   1F0D(1)  	MOV		DATAL,A
   322  0000B5   C193(2)  	CALL		DATA_TO_EEPROM_FUN
   323  0000B6   C306(2)  	CALL	DELAY_LONG
   324  0000B7   2D1F(1)  	MOV		A,#EE_DELAY_ADD_H
   325  0000B8   1F13(1)  	MOV		MAC_H,A
   326  0000B9   2DF8(1)  	MOV		A,#EE_GAP_ADD_L
   327  0000BA   1F14(1)  	MOV		MAC_L,A
   328  0000BB   1E15(1)  	MOV		A,FRONT_DELAY
   329  0000BC   1F0C(1)  	MOV		DATAH,A
   330  0000BD   1E16(1)  	MOV		A,TIME_DELAY_GAP
   331  0000BE   1F0D(1)  	MOV		DATAL,A
   332  0000BF   C193(2)  	CALL		DATA_TO_EEPROM_FUN
   333  0000C0   C306(2)  	CALL	DELAY_LONG
   334  0000C1             
   335  0000C1             
   336  0000C1             SET_WRITE_EE_START_ADD:
   337  0000C1   1E17(1)  	MOV			A,STARTADDRH
   338  0000C2   1F0E(1)  	MOV			ADDRESSH,A
   339  0000C3   1E18(1)  	MOV			A,STARTADDRL
   340  0000C4   1F0F(1)  	MOV			ADDRESSL,A
   341  0000C5             	
   342  0000C5   5906(1+S)  	BTS1		RESET_FLAG
   343  0000C6   80E7(2)  	JMP			FRONT_DELAY_MODE
   344  0000C7             RESET_EEPROM:
   345  0000C7   2DFF(1)  	MOV		A,#0XFF
   346  0000C8   1F0C(1)  	MOV		DATAH,A
   347  0000C9   2DFF(1)  	MOV		A,#0XFF
   348  0000CA   1F0D(1)  	MOV		DATAL,A
   349  0000CB   2D00(1)  	MOV		A,#0X00
   350  0000CC   1F13(1)  	MOV		MAC_H,A
   351  0000CD             RESET_EE_LOOP_H:
   352  0000CD   2D00(1)  	MOV		A,#0X00
   353  0000CE   1F14(1)  	MOV		MAC_L,A
   354  0000CF             RESET_EE_LOOP_L:
   355  0000CF   C193(2)  	CALL		DATA_TO_EEPROM_FUN
   356  0000D0   1614(1+S)  	INCMS	MAC_L
   357  0000D1   80CF(2)  	JMP		RESET_EE_LOOP_L
   358  0000D2   1613(1+S)  	INCMS	MAC_H
   359  0000D3   1E13(1)  	MOV		A,MAC_H
   360  0000D4   0620(1+S)  	CMPRS	A,#0X20
   361  0000D5   80CD(2)  	JMP		RESET_EE_LOOP_H
   362  0000D6   2B0F(1)  	CLR		ADDRESSL
   363  0000D7   2B0E(1)  	CLR		ADDRESSH
   364  0000D8   2D1F(1)  	MOV		A,#LAST_TIME_EE_ADD_H
   365  0000D9   1F13(1)  	MOV		MAC_H,A
   366  0000DA   2DFE(1)  	MOV		A,#LAST_TIME_EE_ADD_L
   367  0000DB   1F14(1)  	MOV		MAC_L,A
   368  0000DC   1E0E(1)  	MOV		A,ADDRESSH
   369  0000DD   1F0C(1)  	MOV		DATAH,A
   370  0000DE   1E0F(1)  	MOV		A,ADDRESSL
   371  0000DF   1F0D(1)  	MOV		DATAL,A
   372  0000E0   C193(2)  	CALL		DATA_TO_EEPROM_FUN
   373  0000E1   2D1F(1)  	MOV			A,#LIVE_TIME_ADD_H
   374  0000E2   1F13(1)  	MOV			MAC_H,A
   375  0000E3   2DFC(1)  	MOV			A,#LIVE_TIME_ADD_L
   376  0000E4   1F14(1)  	MOV			MAC_L,A
   377  0000E5   C193(2)  	CALL		DATA_TO_EEPROM_FUN
   378  0000E6   4106(1)  	BCLR		RESET_FLAG
   379  0000E7             ;******************************************
   380  0000E7             FRONT_DELAY_MODE:
   381  0000E7   6FDF(1)  	B0BSET		FGIE
   382  0000E8   C358(2)  	CALL		SET_LOW_POWER_FUN
   383  0000E9             ;DELAY WAIT_FOR_SEAVAL_MINITE_FUN
   384  0000E9             ;/////////////////////////////////////////	
   385  0000E9   1E15(1)  	MOV   	A,FRONT_DELAY
   386  0000EA   1F10(1)  	MOV		CRCT1,A
   387  0000EB             FRONT_DELAY_LOOP:
   388  0000EB             	GreenMode
   389  0000EB   6CCA(1)  		B0BSET	FCPUM1
   390  0000EC   0000(1)  		NOP
   391  0000ED   0000(1)  		NOP
   392  0000EE   5407(1+S)  	BTS0	NOT_QUICK_MODE_FLAG
   393  0000EF   C34F(2)  	CALL	SET_EE_TM_FUN
   394  0000F0   5207(1+S)  	BTS0	NOT_UPLOAD_FLAG
   395  0000F1   C358(2)  	CALL	SET_LOW_POWER_FUN
   396  0000F2   5B06(1+S)  	BTS1	TIME_FLAG
   397  0000F3   80EB(2)  	JMP		FRONT_DELAY_LOOP
   398  0000F4   4306(1)  	BCLR	TIME_FLAG
   399  0000F5   2610(1+S)  	DECMS	CRCT1
   400  0000F6   80EB(2)  	JMP		FRONT_DELAY_LOOP
   401  0000F7             	;///////////////////////////
   402  0000F7   4207(1)  	BCLR		NOT_UPLOAD_FLAG
   403  0000F8   4307(1)  	BCLR		HAVE_UPLOAD_FLAG
   404  0000F9   4607(1)  	BCLR		BLE_FLAG
   405  0000FA             ;//////////////////////////////////////
   406  0000FA             MAIN:
   407  0000FA             	;close tc0 interrupt until the recording finished 
   408  0000FA             	GreenMode
   409  0000FA   6CCA(1)  		B0BSET	FCPUM1
   410  0000FB   0000(1)  		NOP
   411  0000FC   0000(1)  		NOP
   412  0000FD             	
   413  0000FD             JUST_I2CSLAVE_MODE:
   414  0000FD   5806(1+S)  	BTS1	READTM_FLAG
   415  0000FE   8142(2)  	JMP		JUST_UPLOAD_MODE
   416  0000FF   5506(1+S)  	BTS0	FILLOUT_FLAG
   417  000100   8160(2)  	JMP		MEM_FILLOUT_MODE
   418  000101   7CC9(1+S)  	B0BTS1	FT0IEN
   419  000102   8142(2)  	JMP		JUST_UPLOAD_MODE
   420  000103             ;*****START TM I2C SLAVE MODE***********
   421  000103             I2CSLAVE_MODE:
   422  000103   4006(1)  	BCLR 	READTM_FLAG
   423  000104   59D1(1+S)  	BTS1	VDDF
   424  000105   8134(2)  	JMP		ADDRESS_CHANGE
   425  000106   5CD2(1+S)  	BTS1	BLEF
   426  000107   8134(2)  	JMP		ADDRESS_CHANGE
   427  000108   4607(1)  	BCLR	BLE_FLAG
   428  000109   67DF(1)  	B0BCLR 	FGIE
   429  00010A   6CC5(1)  	B0BSET	VTM_CONT
   430  00010B   6BD2(1)  	B0BSET	S_TM_EE_IO
   431  00010C   60D0(1)  	B0BCLR	VSR_IO
   432  00010D   2D34(1)  	MOV		A,#TM_DATA_H
   433  00010E   1F13(1)  	MOV		MAC_H,A
   434  00010F   2D00(1)  	MOV		A,#TM_DATA_L
   435  000110   1F14(1)  	MOV		MAC_L,A
   436  000111   C1F7(2)  	CALL	GET_DATA_FROM_TM_FUN
   437  000112   64D5(1)  	B0BCLR		VTM_IO
   438  000113   C300(2)  	CALL		DELAY_SHORT
   439  000114   63D2(1)  	B0BCLR		S_TM_EE_IO
   440  000115   64C5(1)  	B0BCLR		VTM_CONT
   441  000116   C300(2)  	CALL		DELAY_SHORT
   442  000117   1E0E(1)  	MOV		A,ADDRESSH
   443  000118   1F13(1)  	MOV		MAC_H,A
   444  000119   1E0F(1)  	MOV		A,ADDRESSL
   445  00011A   1F14(1)  	MOV		MAC_L,A
   446  00011B   C193(2)  	CALL		DATA_TO_EEPROM_FUN
   447  00011C   2D1F(1)  	MOV		A,#LAST_TIME_EE_ADD_H
   448  00011D   1F13(1)  	MOV		MAC_H,A
   449  00011E   2DFE(1)  	MOV		A,#LAST_TIME_EE_ADD_L
   450  00011F   1F14(1)  	MOV		MAC_L,A
   451  000120   1E0E(1)  	MOV		A,ADDRESSH
   452  000121   1F0C(1)  	MOV		DATAH,A
   453  000122   1E0F(1)  	MOV		A,ADDRESSL
   454  000123   1F0D(1)  	MOV		DATAL,A
   455  000124   C193(2)  	CALL		DATA_TO_EEPROM_FUN
   456  000125   74C8(1+S)  	B0BTS0		FT0IRQ
   457  000126   1608(1+S)  	INCMS		TIMEH
   458  000127   64C8(1)  	B0BCLR		FT0IRQ
   459  000128   6FDF(1)  	B0BSET		FGIE
   460  000129   2D78(1)  	MOV			A,#TIME_GAP
   461  00012A   0708(1+S)  	CMPRS		A,TIMEH
   462  00012B   8134(2)  	JMP			ADDRESS_CHANGE
   463  00012C   2B08(1)  	CLR			TIMEH
   464  00012D   4B06(1)  	BSET		TIME_FLAG
   465  00012E   1609(1+S)  	INCMS		TIMEG
   466  00012F   1E16(1)  	MOV			A,TIME_DELAY_GAP
   467  000130   0709(1+S)  	CMPRS		A,TIMEG
   468  000131   8134(2)  	JMP			ADDRESS_CHANGE
   469  000132   2B09(1)  	CLR			TIMEG
   470  000133   4806(1)  	BSET		READTM_FLAG
   471  000134             ADDRESS_CHANGE:
   472  000134   2D02(1)  	MOV			A,#0X02
   473  000135   130F(1)  	ADD			ADDRESSL,A
   474  000136   2D00(1)  	MOV			A,#0X00
   475  000137   110E(1)  	ADC			ADDRESSH,A
   476  000138   2D1F(1)  	MOV			A,#MAX_MEMH
   477  000139   070E(1+S)  	CMPRS		A,ADDRESSH
   478  00013A   80FD(2)  	JMP			JUST_I2CSLAVE_MODE
   479  00013B   2DF0(1)  	MOV			A,#MAX_MEML
   480  00013C   070F(1+S)  	CMPRS		A,ADDRESSL
   481  00013D   80FD(2)  	JMP			JUST_I2CSLAVE_MODE
   482  00013E   4D06(1)  	BSET		FILLOUT_FLAG
   483  00013F   67D8(1)  	B0BCLR		FT0ENB
   484  000140   64C9(1)  	B0BCLR		FT0IEN
   485  000141   8160(2)  	JMP			MEM_FILLOUT_MODE
   486  000142             ;*****************************************
   487  000142             JUST_UPLOAD_MODE:
   488  000142   62C2(1)  	B0BCLR		CLED_CONT
   489  000143   C300(2)  	CALL		DELAY_SHORT
   490  000144   C300(2)  	CALL		DELAY_SHORT
   491  000145   7AD2(1+S)  	B0BTS1		CLED_IO
   492  000146   817D(2)  	JMP			RESET_MODE
   493  000147             BLE_EE_UPLOAD_MODE:
   494  000147   5607(1+S)  	BTS0		BLE_FLAG
   495  000148   814E(2)  	JMP			END_BLE_EE_MODE
   496  000149   54D2(1+S)  	BTS0		BLEF
   497  00014A   8152(2)  	JMP			TM_EE_UPLOAD_MODE
   498  00014B   4E07(1)  	BSET		BLE_FLAG
   499  00014C   C358(2)  	CALL		SET_LOW_POWER_FUN
   500  00014D   8160(2)  	JMP			MEM_FILLOUT_MODE
   501  00014E             END_BLE_EE_MODE:
   502  00014E   5CD2(1+S)  	BTS1		BLEF
   503  00014F   8160(2)  	JMP			MEM_FILLOUT_MODE
   504  000150   C358(2)  	CALL		SET_LOW_POWER_FUN
   505  000151   4607(1)  	BCLR		BLE_FLAG
   506  000152             TM_EE_UPLOAD_MODE:
   507  000152   5206(1+S)  	BTS0		TM_EE_FLAG
   508  000153   815A(2)  	JMP			END_TM_EE_MODE
   509  000154   51D1(1+S)  	BTS0		VDDF
   510  000155   8160(2)  	JMP			MEM_FILLOUT_MODE
   511  000156             TM_EE_MODE:
   512  000156   4307(1)  	BCLR		HAVE_UPLOAD_FLAG
   513  000157   5206(1+S)  	BTS0		TM_EE_FLAG
   514  000158   815A(2)  	JMP			END_TM_EE_MODE
   515  000159   C34F(2)  	CALL		SET_EE_TM_FUN
   516  00015A             END_TM_EE_MODE:
   517  00015A             	;BTS0		FILLOUT_FLAG
   518  00015A             	;JMP			MEM_FILLOUT_MODE	
   519  00015A   59D1(1+S)  	BTS1		VDDF
   520  00015B   8160(2)  	JMP			MEM_FILLOUT_MODE
   521  00015C   C358(2)  	CALL		SET_LOW_POWER_FUN
   522  00015D   5506(1+S)  	BTS0		FILLOUT_FLAG
   523  00015E   8160(2)  	JMP			MEM_FILLOUT_MODE
   524  00015F             	;we should keep rtc function 
   525  00015F   8174(2)  	JMP		ON_LED_MODE
   526  000160             ;*************************************
   527  000160             MEM_FILLOUT_MODE:
   528  000160   5D06(1+S)  	BTS1	FILLOUT_FLAG
   529  000161   8174(2)  	JMP		ON_LED_MODE
   530  000162   79D1(1+S)  	B0BTS1	VDDF
   531  000163   8167(2)  	JMP		$+4
   532  000164   5206(1+S)  	BTS0	TM_EE_FLAG
   533  000165   C358(2)  	CALL	SET_LOW_POWER_FUN
   534  000166   8169(2)  	JMP		$+3
   535  000167   5A06(1+S)  	BTS1	TM_EE_FLAG
   536  000168   C34F(2)  	CALL	SET_EE_TM_FUN
   537  000169   7FD8(1+S)  	B0BTS1		FT0ENB
   538  00016A   816F(2)  	JMP			$+5
   539  00016B   2BD9(1)  	CLR			T0C
   540  00016C   64C8(1)  	B0BCLR		FT0IRQ
   541  00016D   64C9(1)  	B0BCLR		FT0IEN
   542  00016E   67D8(1)  	B0BCLR		FT0ENB
   543  00016F             	SleepMode
   544  00016F   6BCA(1)  		B0BSET	FCPUM0
   545  000170             END_FILLOUT_MODE:
   546  000170   6AC2(1)  	B0BSET		CLED_CONT
   547  000171   6AD2(1)  	B0BSET		CLED_IO
   548  000172   C2FB(2)  	CALL		DELAY_MINI
   549  000173   8142(2)  	JMP		JUST_UPLOAD_MODE
   550  000174             ON_LED_MODE:
   551  000174   6AC2(1)  	B0BSET	CLED_CONT
   552  000175   6AD2(1)  	B0BSET	CLED_IO
   553  000176   5107(1+S)  	BTS0	READ_LED_FLAG
   554  000177   C182(2)  	CALL	READ_LED_FUN
   555  000178   4107(1)  	BCLR   	READ_LED_FLAG
   556  000179   6AD2(1)  	B0BSET	CLED_IO
   557  00017A   5506(1+S)  	BTS0	FILLOUT_FLAG
   558  00017B   8142(2)  	JMP		JUST_UPLOAD_MODE
   559  00017C   80FA(2)  	JMP		MAIN
   560  00017D             RESET_MODE:
   561  00017D   4906(1)  	BSET	RESET_FLAG
   562  00017E   4506(1)  	BCLR	FILLOUT_FLAG
   563  00017F   2B08(1)  	CLR		TIMEH
   564  000180   2B09(1)  	CLR		TIMEG
   565  000181   8038(2)  	JMP		STATE_INITIAL
   566  000182             	
   567  000182             ;******************************************************************************	
   568  000182             READ_LED_FUN:
   569  000182   2D01(1)     	MOV  	   	A,#1
   570  000183   1F05(1)     	MOV  	   	TLC2,A
   571  000184             LED_MODEL1:	
   572  000184   6AD2(1)     	B0BSET   	CLED_IO
   573  000185   C310(2)     	CALL   	   	DELAY_LED
   574  000186   62D2(1)     	B0BCLR   	CLED_IO
   575  000187   C310(2)     	CALL   	   	DELAY_LED
   576  000188   2605(1+S)     	DECMS   	TLC2
   577  000189   8184(2)     	JMP   	   	LED_MODEL1
   578  00018A   0E00(2)     	RET
   579  00018B             ;*******************************************************
   580  00018B             ;***************************************
   581  00018B             	
   582  00018B             	
   583  00018B             	
   584  00018B             	
   585  00018B             	
   586  00018B             	
   587  00018B             	
   588  00018B             	
   589  00018B             	
   590  00018B             	
   591  00018B             	
   592  00018B             	
   593  00018B             	
   594  00018B             	
   595  00018B             	
   596  00018B             	
   597  00018B             CLRRAM:
   598  00018B             	
   599  00018B   2B84(1)  	CLR			Y
   600  00018C   2D2F(1)  	MOV			A,#END_RAM_ADDR
   601  00018D   2F83(1)  	B0MOV		Z,A
   602  00018E             CLRRAM10:
   603  00018E   2BE7(1)  	CLR			@YZ
   604  00018F   2683(1+S)  	DECMS		Z
   605  000190   818E(2)  	JMP			CLRRAM10
   606  000191   2BE7(1)  	CLR			@YZ
   607  000192   0E00(2)  	RET
   608  000193             ;***********************************
   609  000193             ;***************************************
   610  000193             ;*************WRITE TMEPERATURE INTO EEPROM*************
   611  000193             ;*************RECORDING ADDRESS THE LAST TIME STORAGE THE TMPERATURE VALUE************
   612  000193             ;**************************************
   613  000193             DATA_TO_EEPROM_FUN:
   614  000193   6DC2(1)  	B0BSET		SDA_CONT
   615  000194   6DD2(1)  	B0BSET		SDA_IO
   616  000195   68C2(1)  	B0BSET		SCL_CONT
   617  000196   68D2(1)  	B0BSET		SCL_IO
   618  000197   1E14(1)  	MOV			A,MAC_L
   619  000198   1F11(1)  	MOV			CRCT2,A
   620  000199   1E0C(1)  	MOV			A,DATAH
   621  00019A   1F10(1)  	MOV			CRCT1,A
   622  00019B   2D02(1)  	MOV			A,#0X02
   623  00019C   1F05(1)  	MOV			TLC2,A
   624  00019D             MOVE_DATA_TO_EEPROM:
   625  00019D   C273(2)  	CALL		I2C_START_EE
   626  00019E   2DA0(1)  	MOV			A,#EEW_ADD
   627  00019F   1F0A(1)  	MOV			DATA_IN,A
   628  0001A0   C2C4(2)  	CALL		EEADDRESS_ASK
   629  0001A1   1E13(1)  	MOV			A,MAC_H
   630  0001A2   1F0A(1)  	MOV			DATA_IN,A
   631  0001A3   C2C4(2)  	CALL		EEADDRESS_ASK
   632  0001A4   1E11(1)  	MOV			A,CRCT2
   633  0001A5   1F0A(1)  	MOV			DATA_IN,A
   634  0001A6   C2C4(2)  	CALL		EEADDRESS_ASK
   635  0001A7   C2FB(2)  	CALL		DELAY_MINI
   636  0001A8   1E10(1)  	MOV			A,CRCT1
   637  0001A9   1F0A(1)  	MOV			DATA_IN,A
   638  0001AA   C2C4(2)  	CALL		EEADDRESS_ASK
   639  0001AB   C279(2)  	CALL		I2C_END_EE
   640  0001AC             	
   641  0001AC   C306(2)  	CALL		DELAY_LONG
   642  0001AD   2D01(1)  	MOV			A,#0X01
   643  0001AE   1311(1)  	ADD			CRCT2,A
   644  0001AF   1E0D(1)  	MOV			A,DATAL
   645  0001B0   1F10(1)  	MOV			CRCT1,A
   646  0001B1   2605(1+S)  	DECMS		TLC2
   647  0001B2   819D(2)  	JMP			MOVE_DATA_TO_EEPROM
   648  0001B3             ;*********************************************
   649  0001B3   60C2(1)  	B0BCLR		SCL_CONT
   650  0001B4   0E00(2)  	RET
   651  0001B5             ;**************************************
   652  0001B5             PUT_DATA_INTO_TM_FUN:
   653  0001B5   68C2(1)  	B0BSET	SCL_CONT
   654  0001B6   69C2(1)  	B0BSET	SDATA_CONT
   655  0001B7   61D2(1)  	B0BCLR	SDATA_IO
   656  0001B8   60D2(1)  	B0BCLR	SCL_IO
   657  0001B9   C306(2)  	CALL 	DELAY_LONG
   658  0001BA   C306(2)  	CALL 	DELAY_LONG
   659  0001BB   6CD5(1)  	B0BSET 	VTM_IO
   660  0001BC   C306(2)  	CALL 	DELAY_LONG
   661  0001BD             	;CALL	DELAY_LONG
   662  0001BD             START_TMI2C_S:
   663  0001BD   2D04(1)  	MOV 	A,#0X04
   664  0001BE   1F03(1)  	MOV 	TLC0,A
   665  0001BF             LOOP_1_S:
   666  0001BF   68D2(1)  	B0BSET 	SCL_IO
   667  0001C0   C2FB(2)  	CALL	DELAY_MINI;13US
   668  0001C1   C2FA(2)  	CALL	CALL_DELAY
   669  0001C2   60D2(1)  	B0BCLR 	SCL_IO
   670  0001C3   C2FB(2)  	CALL 	DELAY_MINI
   671  0001C4   2603(1+S)  	DECMS  	TLC0
   672  0001C5   81BF(2)  	JMP 	LOOP_1_S
   673  0001C6   41D2(1)  	BCLR 	SDATA_IO
   674  0001C7   C306(2)  	CALL	DELAY_LONG
   675  0001C8   C306(2)  	CALL	DELAY_LONG
   676  0001C9   2D04(1)  	MOV 	A,#4
   677  0001CA   2F03(1)  	B0MOV 	TLC0,A
   678  0001CB             LOOP_2_S:
   679  0001CB   60D2(1)  	B0BCLR 	SCL_IO
   680  0001CC   C2FB(2)  	CALL	DELAY_MINI
   681  0001CD   C2FA(2)  	CALL	CALL_DELAY
   682  0001CE   68D2(1)  	B0BSET 	SCL_IO
   683  0001CF   C2FB(2)  	CALL	DELAY_MINI
   684  0001D0   2603(1+S)  	DECMS 	TLC0
   685  0001D1   81CB(2)  	JMP 	LOOP_2_S
   686  0001D2   C300(2)  	CALL	DELAY_SHORT
   687  0001D3   2D14(1)  	MOV 	A,#20
   688  0001D4   2F03(1)  	B0MOV 	TLC0,A
   689  0001D5   49D2(1)  	BSET 	SDATA_IO
   690  0001D6             WAIT_TM_INIT_S:
   691  0001D6   C306(2)  	CALL 		DELAY_LONG
   692  0001D7   2603(1+S)  	DECMS 		TLC0
   693  0001D8   81D6(2)  	JMP 		WAIT_TM_INIT_S
   694  0001D9             ;**************START*****************************
   695  0001D9   C280(2)  	CALL		I2C_START_TM
   696  0001DA             ;***********************************************
   697  0001DA   2D3C(1)  	MOV 		A,#TMW_ADD
   698  0001DB   1F0A(1)  	MOV 		DATA_IN,A
   699  0001DC   C28E(2)  	CALL 		TMADDRESS_ASK
   700  0001DD   5507(1+S)  	BTS0		TM_I2C_EEROR
   701  0001DE   81F1(2)  	JMP			END_TM_S
   702  0001DF   1E13(1)  	MOV 		A,MAC_H
   703  0001E0   1F0A(1)  	MOV 		DATA_IN,A
   704  0001E1   C28E(2)  	CALL 		TMADDRESS_ASK
   705  0001E2   1E14(1)  	MOV 		A,MAC_L
   706  0001E3   1F0A(1)  	MOV 		DATA_IN,A
   707  0001E4   C28E(2)  	CALL 		TMADDRESS_ASK
   708  0001E5   C306(2)  	CALL		DELAY_LONG
   709  0001E6   1E0C(1)  	MOV 		A,DATAH
   710  0001E7   1F0A(1)  	MOV 		DATA_IN,A
   711  0001E8   C28E(2)  	CALL 		TMADDRESS_ASK
   712  0001E9   1E0D(1)  	MOV 		A,DATAL
   713  0001EA   1F0A(1)  	MOV 		DATA_IN,A
   714  0001EB   C28E(2)  	CALL 		TMADDRESS_ASK
   715  0001EC   C300(2)  	CALL		DELAY_SHORT
   716  0001ED             ;**************END*******************************
   717  0001ED   C286(2)  	CALL		I2C_END_TM
   718  0001EE   C306(2)  	CALL		DELAY_LONG
   719  0001EF   C306(2)  	CALL		DELAY_LONG
   720  0001F0   61D2(1)  	B0BCLR		SDATA_IO
   721  0001F1             END_TM_S:
   722  0001F1   4507(1)  	BCLR		TM_I2C_EEROR
   723  0001F2   64D5(1)  	B0BCLR 		VTM_IO
   724  0001F3   61C2(1)  	B0BCLR		SDATA_CONT
   725  0001F4   60C2(1)  	B0BCLR		SCL_CONT
   726  0001F5   C300(2)  	CALL 		DELAY_SHORT
   727  0001F6   0E00(2)  	RET
   728  0001F7             ;*******************************************
   729  0001F7             ;*****************************************
   730  0001F7             GET_DATA_FROM_TM_FUN:
   731  0001F7   2D0F(1)  	MOV		A,#0X0F
   732  0001F8   1F12(1)  	MOV		COUNT,A
   733  0001F9             TM_I2C_WORK_LOOP:
   734  0001F9   68C2(1)  	B0BSET	SCL_CONT
   735  0001FA   69C2(1)  	B0BSET	SDATA_CONT
   736  0001FB   61D2(1)  	B0BCLR	SDATA_IO
   737  0001FC   60D2(1)  	B0BCLR	SCL_IO
   738  0001FD   C306(2)  	CALL 	DELAY_LONG
   739  0001FE   C306(2)  	CALL 	DELAY_LONG
   740  0001FF   6CD5(1)  	B0BSET 	VTM_IO
   741  000200   C306(2)  	CALL 	DELAY_LONG
   742  000201             	;CALL	DELAY_LONG
   743  000201             START_TMI2C:
   744  000201   2D04(1)  	MOV 	A,#0X04
   745  000202   1F03(1)  	MOV 	TLC0,A
   746  000203             LOOP_1:
   747  000203   68D2(1)  	B0BSET 	SCL_IO
   748  000204   C2FB(2)  	CALL	DELAY_MINI;13US
   749  000205   C2FA(2)  	CALL	CALL_DELAY
   750  000206   60D2(1)  	B0BCLR 	SCL_IO
   751  000207   C2FB(2)  	CALL 	DELAY_MINI
   752  000208   2603(1+S)  	DECMS  	TLC0
   753  000209   8203(2)  	JMP 	LOOP_1
   754  00020A   2D28(1)  	MOV 	A,#40
   755  00020B   2F03(1)  	B0MOV 	TLC0,A
   756  00020C   41D2(1)  	BCLR 	SDATA_IO
   757  00020D   C306(2)  	CALL	DELAY_LONG
   758  00020E             	;CALL	DELAY_SHORT
   759  00020E   2D04(1)  	MOV 	A,#4
   760  00020F   2F03(1)  	B0MOV 	TLC0,A
   761  000210             LOOP_2:
   762  000210   60D2(1)  	B0BCLR 	SCL_IO
   763  000211   C2FB(2)  	CALL	DELAY_MINI
   764  000212   C2FA(2)  	CALL	CALL_DELAY
   765  000213   68D2(1)  	B0BSET 	SCL_IO
   766  000214   C2FB(2)  	CALL	DELAY_MINI
   767  000215   2603(1+S)  	DECMS 	TLC0
   768  000216   8210(2)  	JMP 	LOOP_2
   769  000217   C300(2)  	CALL	DELAY_SHORT
   770  000218   2D05(1)  	MOV 	A,#5
   771  000219   2F03(1)  	B0MOV 	TLC0,A
   772  00021A   49D2(1)  	BSET 	SDATA_IO
   773  00021B             WAIT_TM_INIT:
   774  00021B   C306(2)  	CALL 		DELAY_LONG
   775  00021C   2603(1+S)  	DECMS 		TLC0
   776  00021D   821B(2)  	JMP 		WAIT_TM_INIT
   777  00021E             ;**************START*****************************
   778  00021E   C280(2)  	CALL		I2C_START_TM
   779  00021F             ;***********************************************
   780  00021F   2D3D(1)  	MOV 		A,#TMR_ADD
   781  000220   1F0A(1)  	MOV 		DATA_IN,A
   782  000221   C28E(2)  	CALL 		TMADDRESS_ASK
   783  000222   5507(1+S)  	BTS0		TM_I2C_EEROR
   784  000223   8242(2)  	JMP			END_TM
   785  000224   1E13(1)  	MOV 		A,MAC_H
   786  000225   1F0A(1)  	MOV 		DATA_IN,A
   787  000226   C28E(2)  	CALL 		TMADDRESS_ASK
   788  000227   1E14(1)  	MOV 		A,MAC_L
   789  000228   1F0A(1)  	MOV 		DATA_IN,A
   790  000229   C28E(2)  	CALL 		TMADDRESS_ASK
   791  00022A   61C2(1)  	B0BCLR		SDATA_CONT
   792  00022B   C306(2)  	CALL 		DELAY_LONG
   793  00022C   4706(1)  	BCLR 		ASK_FLAG
   794  00022D   C2A8(2)  	CALL 		TMDATA_ASK
   795  00022E   1E0B(1)  	MOV 		A,DATA_OUT
   796  00022F   1F0C(1)  	MOV 		DATAH,A
   797  000230   4F06(1)  	BSET 		ASK_FLAG
   798  000231   C2A8(2)  	CALL 		TMDATA_ASK
   799  000232   1E0B(1)  	MOV 		A,DATA_OUT
   800  000233   1F0D(1)  	MOV 		DATAL,A		
   801  000234             ;**************END*******************************
   802  000234   C286(2)  	CALL		I2C_END_TM
   803  000235   C300(2)  	CALL		DELAY_SHORT
   804  000236   61D2(1)  	B0BCLR		SDATA_IO
   805  000237   2612(1+S)  	DECMS		COUNT
   806  000238   823A(2)  	JMP			$+2
   807  000239   8242(2)  	JMP			END_TM
   808  00023A   64D5(1)  	B0BCLR 		VTM_IO
   809  00023B   2D00(1)  	MOV			A,#0X00
   810  00023C   070C(1+S)  	CMPRS		A,DATAH
   811  00023D   8241(2)  	JMP			$+4
   812  00023E   070D(1+S)  	CMPRS		A,DATAL
   813  00023F   8241(2)  	JMP			$+2
   814  000240   81F9(2)  	JMP			TM_I2C_WORK_LOOP
   815  000241   4907(1)  	BSET		READ_LED_FLAG
   816  000242             END_TM:
   817  000242   4507(1)  	BCLR		TM_I2C_EEROR
   818  000243   64D5(1)  	B0BCLR 		VTM_IO
   819  000244   61C2(1)  	B0BCLR		SDATA_CONT
   820  000245   60C2(1)  	B0BCLR		SCL_CONT
   821  000246   C300(2)  	CALL 		DELAY_SHORT
   822  000247   0E00(2)  	RET
   823  000248             ;*******************************************
   824  000248             ;***********************************************************
   825  000248             ;*********************************************************
   826  000248             GET_DATA_FROM_EE_FUN:
   827  000248   68C2(1)  	B0BSET		SCL_CONT
   828  000249   6DC2(1)  	B0BSET		SDA_CONT
   829  00024A   6DD2(1)  	B0BSET		SDA_IO
   830  00024B   68D2(1)  	B0BSET		SCL_IO
   831  00024C   C300(2)  	CALL		DELAY_SHORT
   832  00024D   C273(2)  	CALL		I2C_START_EE
   833  00024E   2DA0(1)  	MOV			A,#EEW_ADD
   834  00024F   1F0A(1)  	MOV			DATA_IN,A
   835  000250   C2C4(2)  	CALL		EEADDRESS_ASK
   836  000251   1E13(1)  	MOV			A,MAC_H
   837  000252   1F0A(1)  	MOV			DATA_IN,A
   838  000253   C2C4(2)  	CALL		EEADDRESS_ASK
   839  000254   1E14(1)  	MOV			A,MAC_L
   840  000255   1F0A(1)  	MOV			DATA_IN,A
   841  000256   C2C4(2)  	CALL		EEADDRESS_ASK
   842  000257   6DD2(1)  	B0BSET		SDA_IO
   843  000258   C300(2)  	CALL		DELAY_SHORT
   844  000259   68D2(1)  	B0BSET		SCL_IO
   845  00025A   C300(2)  	CALL		DELAY_SHORT
   846  00025B   C273(2)  	CALL		I2C_START_EE
   847  00025C   C300(2)  	CALL		DELAY_SHORT
   848  00025D   2DA1(1)  	MOV			A,#EER_ADD
   849  00025E   1F0A(1)  	MOV			DATA_IN,A
   850  00025F   C2C4(2)  	CALL		EEADDRESS_ASK
   851  000260   65C2(1)  	B0BCLR		SDA_CONT
   852  000261   4706(1)  	BCLR		ASK_FLAG
   853  000262   C2DE(2)  	CALL		EEDATA_ASK
   854  000263   1E0B(1)  	MOV			A,DATA_OUT
   855  000264   1F0E(1)  	MOV			ADDRESSH,A
   856  000265   65C2(1)  	B0BCLR		SDA_CONT
   857  000266   C2FB(2)  	CALL		DELAY_MINI
   858  000267   4F06(1)  	BSET		ASK_FLAG
   859  000268   C2DE(2)  	CALL		EEDATA_ASK
   860  000269   1E0B(1)  	MOV			A,DATA_OUT
   861  00026A   1F0F(1)  	MOV			ADDRESSL,A
   862  00026B   C279(2)  	CALL		I2C_END_EE
   863  00026C             ;*************************************
   864  00026C   C300(2)  	CALL		DELAY_SHORT
   865  00026D   60C2(1)  	B0BCLR		SCL_CONT
   866  00026E   0E00(2)  	RET
   867  00026F             ;************************************************
   868  00026F             I2C_EEROR:
   869  00026F             	;open interrupt
   870  00026F             	;SleepMode
   871  00026F   4606(1)  	BCLR	I2CERROR_FLAG
   872  000270   54D5(1+S)  	BTS0	VTM_IO
   873  000271   4D07(1)  	BSET	TM_I2C_EEROR
   874  000272   0E00(2)  	RET
   875  000273             I2C_START_EE:
   876  000273   C2FB(2)  	CALL		DELAY_MINI
   877  000274   65D2(1)  	B0BCLR 		SDA_IO
   878  000275   C2FB(2)  	CALL 		DELAY_MINI
   879  000276   60D2(1)  	B0BCLR 		SCL_IO
   880  000277   C2FB(2)  	CALL 		DELAY_MINI
   881  000278   0E00(2)  	RET
   882  000279             I2C_END_EE:
   883  000279   65D2(1)  	B0BCLR 		SDA_IO
   884  00027A   C2FB(2)  	CALL 		DELAY_MINI
   885  00027B   68D2(1)  	B0BSET 		SCL_IO
   886  00027C   C2FB(2)  	CALL 		DELAY_MINI
   887  00027D   6DD2(1)  	B0BSET 		SDA_IO
   888  00027E   C2FB(2)  	CALL		DELAY_MINI
   889  00027F   0E00(2)  	RET
   890  000280             I2C_START_TM:
   891  000280   C2FB(2)  	CALL		DELAY_MINI
   892  000281   61D2(1)  	B0BCLR 		SDATA_IO
   893  000282   C2FB(2)  	CALL 		DELAY_MINI
   894  000283   60D2(1)  	B0BCLR 		SCL_IO
   895  000284   C2FB(2)  	CALL 		DELAY_MINI
   896  000285   0E00(2)  	RET
   897  000286             I2C_END_TM:
   898  000286   61D2(1)  	B0BCLR 		SDATA_IO
   899  000287   C2FB(2)  	CALL 		DELAY_MINI
   900  000288   60D2(1)  	B0BCLR		SCL_IO
   901  000289   C2FB(2)  	CALL		DELAY_MINI
   902  00028A   69D2(1)  	B0BSET 		SDATA_IO
   903  00028B   C2FB(2)  	CALL		DELAY_MINI
   904  00028C   68D2(1)  	B0BSET 		SCL_IO
   905  00028D   0E00(2)  	RET
   906  00028E             TMADDRESS_ASK:
   907  00028E   2D08(1)  	MOV 		A,#8
   908  00028F   1F02(1)  	MOV 		TIMEOUT,A
   909  000290             TMADDRESS_LOOP:
   910  000290   570A(1+S)  	BTS0		DATA_IN.7
   911  000291   8295(2)  	JMP 		MD_1
   912  000292   71D2(1+S)  	B0BTS0 		SDATA_IO
   913  000293   61D2(1)  	B0BCLR		SDATA_IO
   914  000294   8297(2)  	JMP 		NEXT_1
   915  000295             MD_1:
   916  000295   79D2(1+S)  	B0BTS1 		SDATA_IO
   917  000296   69D2(1)  	B0BSET		SDATA_IO
   918  000297             NEXT_1:
   919  000297   C2FB(2)  	CALL		DELAY_MINI
   920  000298   68D2(1)  	B0BSET 		SCL_IO
   921  000299   C2FB(2)  	CALL		DELAY_MINI
   922  00029A   0B0A(1)  	RLCM 		DATA_IN
   923  00029B   60D2(1)  	B0BCLR 		SCL_IO
   924  00029C   2602(1+S)  	DECMS 		TIMEOUT
   925  00029D   8290(2)  	JMP 		TMADDRESS_LOOP
   926  00029E             	
   927  00029E   61C2(1)  	B0BCLR 		SDATA_CONT
   928  00029F   C2FB(2)  	CALL		DELAY_MINI
   929  0002A0   68D2(1)  	B0BSET 		SCL_IO
   930  0002A1   C2FA(2)  	CALL 		CALL_DELAY
   931  0002A2   71D2(1+S)  	B0BTS0 		SDATA_IO
   932  0002A3   C26F(2)  	CALL		I2C_EEROR
   933  0002A4   C2FB(2)  	CALL		DELAY_MINI
   934  0002A5   40D2(1)  	BCLR 		SCL_IO
   935  0002A6   49C2(1)  	BSET 		SDATA_CONT
   936  0002A7   0E00(2)  	RET
   937  0002A8             ;**********************TM_READING_DATA********************************
   938  0002A8             TMDATA_ASK:
   939  0002A8   61C2(1)  	B0BCLR 		SDATA_CONT
   940  0002A9   2D08(1)  	MOV 		A,#8
   941  0002AA   1F02(1)  	MOV 		TIMEOUT,A
   942  0002AB             TMDATA_LOOP:
   943  0002AB   2D09(1)  	MOV 		A,#9
   944  0002AC   1F03(1)  	MOV 		TLC0,A
   945  0002AD   C2FB(2)  	CALL		DELAY_MINI
   946  0002AE   48D2(1)  	BSET 		SCL_IO
   947  0002AF   C2FA(2)  	CALL 		CALL_DELAY
   948  0002B0   71D2(1+S)  	B0BTS0 		SDATA_IO
   949  0002B1   480B(1)  	BSET 		DATA_OUT.0
   950  0002B2   79D2(1+S)  	B0BTS1 		SDATA_IO
   951  0002B3   400B(1)  	BCLR 		DATA_OUT.0
   952  0002B4   0B0B(1)  	RLCM 		DATA_OUT
   953  0002B5   C2FB(2)  	CALL		DELAY_MINI
   954  0002B6   60D2(1)  	B0BCLR 		SCL_IO
   955  0002B7   2602(1+S)  	DECMS 		TIMEOUT
   956  0002B8   82AB(2)  	JMP 		TMDATA_LOOP
   957  0002B9   69C2(1)  	B0BSET 		SDATA_CONT
   958  0002BA   5706(1+S)  	BTS0 		ASK_FLAG
   959  0002BB   69D2(1)  	B0BSET 		SDATA_IO
   960  0002BC   5F06(1+S)  	BTS1 		ASK_FLAG
   961  0002BD   61D2(1)  	B0BCLR 		SDATA_IO
   962  0002BE   090B(1)  	RRCM 		DATA_OUT
   963  0002BF   C2FB(2)  	CALL		DELAY_MINI
   964  0002C0   48D2(1)  	BSET 		SCL_IO
   965  0002C1   C2FB(2)  	CALL		DELAY_MINI
   966  0002C2   40D2(1)  	BCLR		SCL_IO	
   967  0002C3   0E00(2)  	RET
   968  0002C4             ;******************************************************
   969  0002C4             EEADDRESS_ASK:
   970  0002C4   2D08(1)  	MOV 		A,#8
   971  0002C5   1F02(1)  	MOV 		TIMEOUT,A
   972  0002C6             EEADDRESS_LOOP:
   973  0002C6   570A(1+S)  	BTS0		DATA_IN.7
   974  0002C7   82CB(2)  	JMP 		EEMD_1
   975  0002C8   75D2(1+S)  	B0BTS0 		SDA_IO
   976  0002C9   65D2(1)  	B0BCLR		SDA_IO
   977  0002CA   82CD(2)  	JMP 		EENEXT_1
   978  0002CB             EEMD_1:
   979  0002CB   7DD2(1+S)  	B0BTS1 		SDA_IO
   980  0002CC   6DD2(1)  	B0BSET		SDA_IO
   981  0002CD             EENEXT_1:
   982  0002CD   C2FB(2)  	CALL		DELAY_MINI
   983  0002CE   68D2(1)  	B0BSET 		SCL_IO
   984  0002CF   C2FB(2)  	CALL		DELAY_MINI
   985  0002D0   0B0A(1)  	RLCM 		DATA_IN
   986  0002D1   60D2(1)  	B0BCLR 		SCL_IO
   987  0002D2   2602(1+S)  	DECMS 		TIMEOUT
   988  0002D3   82C6(2)  	JMP 		EEADDRESS_LOOP
   989  0002D4             	
   990  0002D4   65C2(1)  	B0BCLR 		SDA_CONT
   991  0002D5   C2FB(2)  	CALL		DELAY_MINI
   992  0002D6   68D2(1)  	B0BSET 		SCL_IO
   993  0002D7   C2FA(2)  	CALL 		CALL_DELAY
   994  0002D8   75D2(1+S)  	B0BTS0 		SDA_IO
   995  0002D9   C26F(2)  	CALL		I2C_EEROR
   996  0002DA   C2FB(2)  	CALL		DELAY_MINI
   997  0002DB   40D2(1)  	BCLR 		SCL_IO
   998  0002DC   4DC2(1)  	BSET 		SDA_CONT
   999  0002DD   0E00(2)  	RET
  1000  0002DE             ;****************************************
  1001  0002DE             EEDATA_ASK:
  1002  0002DE   65C2(1)  	B0BCLR 		SDA_CONT
  1003  0002DF   2D08(1)  	MOV 		A,#8
  1004  0002E0   1F02(1)  	MOV 		TIMEOUT,A
  1005  0002E1             EEDATA_LOOP:
  1006  0002E1   2D09(1)  	MOV 		A,#9
  1007  0002E2   1F03(1)  	MOV 		TLC0,A
  1008  0002E3   C2FB(2)  	CALL		DELAY_MINI
  1009  0002E4   48D2(1)  	BSET 		SCL_IO
  1010  0002E5   C2FA(2)  	CALL 		CALL_DELAY
  1011  0002E6   75D2(1+S)  	B0BTS0 		SDA_IO
  1012  0002E7   480B(1)  	BSET 		DATA_OUT.0
  1013  0002E8   7DD2(1+S)  	B0BTS1 		SDA_IO
  1014  0002E9   400B(1)  	BCLR 		DATA_OUT.0
  1015  0002EA   0B0B(1)  	RLCM 		DATA_OUT
  1016  0002EB   C2FB(2)  	CALL		DELAY_MINI
  1017  0002EC   60D2(1)  	B0BCLR 		SCL_IO
  1018  0002ED   2602(1+S)  	DECMS 		TIMEOUT
  1019  0002EE   82E1(2)  	JMP 		EEDATA_LOOP
  1020  0002EF             	
  1021  0002EF   6DC2(1)  	B0BSET 		SDA_CONT
  1022  0002F0   5706(1+S)  	BTS0 		ASK_FLAG
  1023  0002F1   6DD2(1)  	B0BSET 		SDA_IO
  1024  0002F2   5F06(1+S)  	BTS1 		ASK_FLAG
  1025  0002F3   65D2(1)  	B0BCLR 		SDA_IO
  1026  0002F4   090B(1)  	RRCM 		DATA_OUT
  1027  0002F5   C2FB(2)  	CALL		DELAY_MINI
  1028  0002F6   48D2(1)  	BSET 		SCL_IO
  1029  0002F7   C2FB(2)  	CALL		DELAY_MINI
  1030  0002F8   40D2(1)  	BCLR		SCL_IO	
  1031  0002F9   0E00(2)  	RET
  1032  0002FA             ;*********************delay*****************
  1033  0002FA             CALL_DELAY:
  1034  0002FA   0E00(2)  	RET
  1035  0002FB             DELAY_MINI:;13US
  1036  0002FB   2D05(1)  	MOV		A,#0X05
  1037  0002FC   1F00(1)  	MOV		DELAYTIME1,A
  1038  0002FD             DELAY0:
  1039  0002FD   2600(1+S)  	DECMS	DELAYTIME1
  1040  0002FE   82FD(2)  	JMP		DELAY0
  1041  0002FF   0E00(2)  	RET
  1042  000300             	
  1043  000300             DELAY_SHORT:		;50US FOR 0.5US/INSTRUCTION
  1044  000300   2D63(1)  	MOV		A,#0X63
  1045  000301   1F00(1)  	MOV		DELAYTIME1,A
  1046  000302             DELAY1:
  1047  000302   0000(1)  	NOP
  1048  000303   2600(1+S)  	DECMS	DELAYTIME1
  1049  000304   8302(2)  	JMP		DELAY1
  1050  000305   0E00(2)  	RET
  1051  000306             DELAY_LONG:	;>=5MS
  1052  000306             ;WAIT_FOR_A_LONG_WHILE
  1053  000306   2D0A(1)  	MOV		A,#0X0A
  1054  000307   2F00(1)  	B0MOV	DELAYTIME1,A
  1055  000308             DELAY2_1:
  1056  000308   2DC7(1)  	MOV		A,#0XC7
  1057  000309   1F01(1)  	MOV		DELAYTIME2,A
  1058  00030A             DELAY2_2:
  1059  00030A   0000(1)  	NOP
  1060  00030B   2601(1+S)  	DECMS	DELAYTIME2
  1061  00030C   830A(2)  	JMP		DELAY2_2	
  1062  00030D   2600(1+S)  	DECMS	DELAYTIME1
  1063  00030E   8308(2)  	JMP		DELAY2_1
  1064  00030F   0E00(2)  	RET		
  1065  000310             DELAY_LED:		;0.2S
  1066  000310             ;WAIT_FOR_DEEP_DARK_FANTASY
  1067  000310   2DFF(1)  	MOV		A,#0XFF
  1068  000311   1F01(1)  	MOV		DELAYTIME2,A
  1069  000312             DELAY3_1:
  1070  000312   2DFF(1)  	MOV		A,#0XFF
  1071  000313   1F00(1)  	MOV		DELAYTIME1,A
  1072  000314             DELAY3_2:
  1073  000314   0000(1)  	NOP
  1074  000315   0000(1)  	NOP
  1075  000316   2600(1+S)  	DECMS		DELAYTIME1
  1076  000317   8314(2)  	JMP			DELAY3_2
  1077  000318   2601(1+S)  	DECMS		DELAYTIME2
  1078  000319   8312(2)  	JMP			DELAY3_1
  1079  00031A   0E00(2)  	RET
  1080  00031B             OPEN_TC0_INT_FUN:
  1081  00031B   6BDA(1)  	B0BSET	FTC0CKS	;	OUTSIDE INPUT ACCIDENT
  1082  00031C   6ADA(1)  	B0BSET	FALOAD0 ;
  1083  00031D   2DFD(1)  	MOV		A,#0XFD
  1084  00031E   2FCD(1)  	B0MOV	TC0R,A
  1085  00031F   2FDB(1)  	B0MOV	TC0C,A
  1086  000320   65C8(1)  	B0BCLR	FTC0IRQ
  1087  000321   6DC9(1)  	B0BSET	FTC0IEN
  1088  000322   6FDA(1)  	B0BSET	FTC0ENB
  1089  000323   0E00(2)  	RET
  1090  000324             SYS_INIT_FUN:
  1091  000324   2D2D(1)  	MOV			A,#0X2D
  1092  000325   2FC2(1)  	B0MOV		P2M,A
  1093  000326   2D35(1)  	MOV			A,#0X35
  1094  000327   2FD2(1)  	B0MOV		P2,A
  1095  000328             	;up resistor for p2.1
  1096  000328             	;MOV			A,#0X02
  1097  000328             	;B0MOV		P2UR,A
  1098  000328   2D01(1)  	MOV			A,#0X01
  1099  000329   2FC1(1)  	B0MOV		P1M,A
  1100  00032A   2BD1(1)  	CLR			P1
  1101  00032B   68B8(1)  	B0BSET		VSR_CONT
  1102  00032C   60D0(1)  	B0BCLR		VSR_IO
  1103  00032D   68C1(1)  	B0BSET		S_VDD_VCC_CONT
  1104  00032E   60D1(1)  	B0BCLR		S_VDD_VCC_IO
  1105  00032F   6CC5(1)  	B0BSET		VTM_CONT
  1106  000330   64D5(1)  	B0BCLR		VTM_IO
  1107  000331   2D03(1)  	MOV			A,#0X03
  1108  000332   1F10(1)  	MOV			CRCT1,A
  1109  000333   C300(2)  	CALL		DELAY_SHORT
  1110  000334   54D2(1+S)  	BTS0		BLEF
  1111  000335   8339(2)  	JMP			SYS_INIT_LED
  1112  000336   4E07(1)  	BSET		BLE_FLAG
  1113  000337   2D02(1)  	MOV			A,#0X02
  1114  000338   1F10(1)  	MOV			CRCT1,A
  1115  000339             SYS_INIT_LED:
  1116  000339   62D2(1)  	B0BCLR		CLED_IO
  1117  00033A   C310(2)  	CALL		DELAY_LED	
  1118  00033B   6AD2(1)  	B0BSET		CLED_IO
  1119  00033C   C310(2)  	CALL		DELAY_LED
  1120  00033D   2610(1+S)  	DECMS		CRCT1
  1121  00033E   8339(2)  	JMP			SYS_INIT_LED
  1122  00033F             ;************T0_INIT_START************************************
  1123  00033F   2D00(1)  	MOV			A,#0X00
  1124  000340   2FD8(1)  	B0MOV		T0M,A	
  1125  000341   68D8(1)  	B0BSET		FT0TB	; T0 = Fcpu/256,PERIOD TIME IS 2S
  1126  000342   2BD9(1)  	CLR			T0C
  1127  000343   64C8(1)  	B0BCLR		FT0IRQ
  1128  000344   6CC9(1)  	B0BSET		FT0IEN
  1129  000345   6FD8(1)  	B0BSET		FT0ENB
  1130  000346             ;*****************TC0_INIT_START*****************
  1131  000346   2BDA(1)  	CLR			TC0M
  1132  000347   2BDB(1)  	CLR			TC0C
  1133  000348   65C8(1)  	B0BCLR		FTC0IRQ
  1134  000349   65C9(1)  	B0BCLR		FTC0IEN
  1135  00034A   67DA(1)  	B0BCLR		FTC0ENB
  1136  00034B             ;************************OPEN P1.1WEEK UP FUNCTION*********************
  1137  00034B   2D02(1)  	MOV			A,#0X02
  1138  00034C   2FC0(1)  	B0MOV		P1W,A
  1139  00034D   C2FB(2)  	CALL		DELAY_MINI
  1140  00034E   0E00(2)  	RET
  1141  00034F             ;//////////////////////////////////////////////////
  1142  00034F             SET_EE_TM_FUN:
  1143  00034F   65C2(1)  	B0BCLR		SDA_CONT
  1144  000350   64C5(1)  	B0BCLR		VTM_CONT
  1145  000351   60C2(1)  	B0BCLR		SCL_CONT
  1146  000352   61C2(1)  	B0BCLR		SDATA_CONT
  1147  000353   68D0(1)  	B0BSET		VSR_IO
  1148  000354   6BD2(1)  	B0BSET		S_TM_EE_IO
  1149  000355   4A06(1)  	BSET		TM_EE_FLAG
  1150  000356   4407(1)  	BCLR	NOT_QUICK_MODE_FLAG
  1151  000357   0E00(2)  	RET
  1152  000358             ;////////////////////////////////////////
  1153  000358             ;////////////SET LOW POWER
  1154  000358             SET_LOW_POWER_FUN:
  1155  000358             ;****************************************
  1156  000358   64C5(1)  	B0BCLR		VTM_CONT
  1157  000359   63D2(1)  	B0BCLR		S_TM_EE_IO
  1158  00035A   60D0(1)  	B0BCLR		VSR_IO
  1159  00035B   4206(1)  	BCLR		TM_EE_FLAG
  1160  00035C   0E00(2)  	RET
  1161  00035D             ;/////////////////////////////////////////	
  1162  00035D             ;*******************************************
  1163  00035D             	ENDP
  1164  00035D             
