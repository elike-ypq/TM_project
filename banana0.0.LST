     1  000000             CHIP		SN8P2501D
     2  000000             //{{SONIX_CODE_OPTION
     3  000000             	.Code_Option	Noise_Filter	Enable
     4  000000             	.Code_Option	Reset_Pin	P11
     5  000000             	.Code_Option	Watch_Dog	Disable
     6  000000             	.Code_Option	High_Clk	IHRC_RTC	;
     7  000000             	.Code_Option	Fcpu		#3     ; Fcpu = Fosc/8
     8  000000             	.Code_Option	Security	Enable
     9  000000             	.Code_Option	LVD		LVD_L		;
    10  000000             //}}SONIX_CODE_OPTION
    11  000000             
    12  E 0000002F         	END_RAM_ADDR	EQU	0X2F
    13  E 000000A1         	EER_ADD			EQU	0XA1	;10100001B
    14  E 000000A0         	EEW_ADD			EQU	0XA0	;10100000B
    15  E 00000030         	RAM_COUNT		EQU	48
    16  E 00000034         	TM_DATA_H		EQU	0X34	;ADDR OF THE TEMPEATURE	OF TM
    17  E 00000000         	TM_DATA_L		EQU	0X00
    18  E 0000000A         	TIME_GAP		EQU	0X0A	;10S
    19  E 00000001         	T0_TDR			EQU	0X01
    20  E 0000003D         	TMR_ADD 		EQU	0X3D
    21  E 0000003C         	TMW_ADD			EQU	0X3C
    22  E 0000001F         	MAX_MEMH		EQU	0X1F
    23  E 000000DE         	MAX_MEML		EQU	0XDE
    24  E 0000001F         	LAST_TIME_EE_ADD_H EQU 0X1F
    25  E 000000FE         	LAST_TIME_EE_ADD_L EQU 0XFE
    26  E 0000001F         	LIVE_TIME_ADD_H		EQU	0X1F
    27  E 000000FC         	LIVE_TIME_ADD_L		EQU	0XFC
    28  E 00000001         	DEFAULT_FRONT_TIME_DELAY	EQU	0X01
    29  E 00000001         	DEFAULT_TIME_GAP	EQU	0X01
    30  E 00000030         	TM_INITIAL_TIME_ADD_H	EQU 0X30
    31  E 00000000         	TM_INITIAL_TIME_ADD_L	EQU 0X00
    32  E 00000031         	TM_TIME_H		EQU	0X31
    33  E 00000000         	TM_TIME_L		EQU	0X00
    34  E 0000001F         	EE_DELAY_ADD_H	EQU	0X1F
    35  E 000000F8         	EE_GAP_ADD_L	EQU	0XF8
    36  E 0000001F         	EE_INITIAL_TIME_ADD_H	EQU	0X1F
    37  E 000000FA         	EE_INITIAL_TIME_ADD_L	EQU	0XFA
    38  E 00000001         	WRITE_FLAG_H	EQU 0X01
    39  E 00000000         	WRITE_FLAG_L	EQU	0X00
    40  E 00000002         	DEFAULT_GAP_TIME_FLAGH EQU 0X02
    41  E 00000000         	DEFAULT_GAP_TIME_FLAGL EQU	0X00
    42  E 00000020         	HIGT_TMP_LEVEL1	EQU	0X20
    43  E 00000005         	LOW_TMP_LEVEL1 EQU	0X05
    44  E 0000001F         	TMP_LEVEL_ADDH	EQU	0X1F
    45  E 000000F0         	TMP_LEVEL_ADDL	EQU	0XF0
    46  000000             .DATA
    47  000000             			ORG	0H
    48  0000 D             	DELAYTIME1	DS	1
    49  0001 D             	DELAYTIME2	DS	1
    50  0002 D             	TIMEOUT		DS	1
    51  0003 D             	TLC0		DS	1
    52  0004 D             	TLC2		DS	1
    53  0005 D             	FLAG1		DS	1
    54  0006 D             	FLAG2		DS	1
    55  0007 D             	TIMEH		DS	1
    56  0008 D             	TIMEG		DS	1
    57  0009 D             	DATA_IN		DS	1
    58  000A D             	DATA_OUT	DS	1
    59  000B D             	DATAH		DS	1
    60  000C D             	DATAL		DS	1
    61  000D D             	ADDRESSH	DS	1
    62  000E D             	ADDRESSL	DS	1
    63  000F D             	CRCT1		DS	1
    64  0010 D             	CRCT2		DS	1
    65  0011 D             	COUNT		DS	1
    66  0012 D             	MAC_H		DS	1
    67  0013 D             	MAC_L		DS	1
    68  0014 D             	FRONT_DELAY	DS	1
    69  0015 D             	TIME_DELAY_GAP	DS	1
    70  0016 D             	STARTADDRH		DS	1
    71  0017 D             	STARTADDRL		DS	1
    72  0018 D             	INITIAL_TIMEH	DS	1
    73  0019 D             	INITIAL_TIMEL	DS	1
    74  001A D             	TEMPERATURE_H	DS	1
    75  00001B             ;**************BIT_VARIABLES_DEFINNITIONS*******
    76  E 00000005         	READTM_FLAG	EQU	FLAG1.0
    77  E 00030005         	TIME_FLAG	EQU	FLAG1.3
    78  E 00010005         	RESET_FLAG	EQU	FLAG1.1
    79  E 00020005         	TM_EE_FLAG	EQU FLAG1.2
    80  E 00040005         	DEFAULT_GAP_FLAG	EQU	FLAG1.4
    81  E 00050005         	FILLOUT_FLAG	EQU	FLAG1.5
    82  E 00060005         	I2CERROR_FLAG	EQU	FLAG1.6
    83  E 00070005         	ASK_FLAG	EQU	FLAG1.7
    84  E 00010006         	READ_LED_FLAG	EQU	FLAG2.1
    85  E 00020006         	NOT_UPLOAD_FLAG	EQU	FLAG2.2
    86  E 00030006         	HAVE_UPLOAD_FLAG EQU FLAG2.3
    87  E 00040006         	NOT_QUICK_MODE_FLAG EQU FLAG2.4
    88  E 00050006         	TM_I2C_EEROR	EQU FLAG2.5
    89  E 00060006         	BLE_FLAG		EQU FLAG2.6
    90  E 00070006         	TMP_LEVEL_FLAG		EQU	FLAG2.7
    91  E 000200D2         	CLED_IO			EQU	P2.2
    92  E 000100D2         	SDATA_IO		EQU	P2.1
    93  E 000000D2         	SCL_IO			EQU	P2.0
    94  E 000300D2         	S_TM_EE_IO		EQU	P2.3
    95  E 000400D2         	BLEF	EQU	P2.4
    96  E 000500D2         	SDA_IO			EQU	P2.5
    97  E 000400D5         	VTM_IO			EQU	P5.4
    98  E 000000D0         	VSR_IO			EQU	P0.0
    99  E 000200C2         	CLED_CONT		EQU	P2M.2
   100  E 000100C2         	SDATA_CONT		EQU	P2M.1
   101  E 000000C2         	SCL_CONT		EQU	P2M.0
   102  E 000300C2         	S_TM_EE_CONT	EQU	P2M.3
   103  E 000500C2         	SDA_CONT		EQU	P2M.5
   104  E 000400C5         	VTM_CONT		EQU	P5M.4
   105  E 000000B8         	VSR_CONT		EQU	P0M.0
   106  00001B             ;***************************************
   107  E 000100D1         	VDDF			EQU	P1.1
   108  E 000000D1         	S_VDD_VCC_IO		EQU	P1.0
   109  E 000000C1         	S_VDD_VCC_CONT		EQU	P1M.0
   110  00001B             ;*************CODE_SECTION**********************	
   111  000000             .CODE
   112  000000             
   113  000000             		ORG	0
   114  000000   8035(2)  	JMP		START
   115  000008             		ORG	8H
   116  000008   8009(2)  	JMP		INT_SERVICE
   117  000009             INT_SERVICE:
   118  000009             ;KEEP ACC AND PFLAG
   119  000009   0400(1)  	PUSH
   120  00000A             ;T0 INTERRUPT
   121  00000A             JUST_T0:
   122  00000A   74C9(1+S)  	B0BTS0	FT0IEN
   123  00000B   7CC8(1+S)  	B0BTS1	FT0IRQ
   124  00000C   802A(2)  	JMP		JUST_TC0
   125  00000D   64C8(1)  	B0BCLR	FT0IRQ
   126  00000E             ;T0 INTERRUPT SERVISE PROGRESS
   127  00000E   71D1(1+S)  	B0BTS0	VDDF
   128  00000F   4A06(1)  	BSET 	NOT_UPLOAD_FLAG
   129  000010   71D1(1+S)  	B0BTS0	VDDF
   130  000011   4306(1)  	BCLR    HAVE_UPLOAD_FLAG
   131  000012             ;///////////////////////////////
   132  000012   5B06(1+S)  	BTS1	HAVE_UPLOAD_FLAG
   133  000013   8016(2)  	JMP		$+3
   134  000014   79D1(1+S)  	B0BTS1	VDDF
   135  000015   4C06(1)  	BSET	NOT_QUICK_MODE_FLAG
   136  000016   79D1(1+S)  	B0BTS1	VDDF
   137  000017   4B06(1)  	BSET    HAVE_UPLOAD_FLAG
   138  000018             ;//////////////////////////////////
   139  000018   1607(1+S)  	INCMS	TIMEH ;TIMEH=TIMEH+1,
   140  000019   2D0A(1)  	MOV			A,#TIME_GAP
   141  00001A   1F10(1)  	MOV			CRCT2,A
   142  00001B   6286(1)  	B0BCLR		FC
   143  00001C   5706(1+S)  	BTS0		TMP_LEVEL_FLAG
   144  00001D   0910(1)  	RRCM		CRCT2
   145  00001E   1E10(1)  	MOV			A,CRCT2
   146  00001F   0707(1+S)  	CMPRS	A,TIMEH
   147  000020   8033(2)  	JMP		EXIT_INT
   148  000021   2B07(1)  	CLR		TIMEH
   149  000022   4B05(1)  	BSET	TIME_FLAG
   150  000023   1608(1+S)  	INCMS	TIMEG
   151  000024   1E15(1)  	MOV		A,TIME_DELAY_GAP
   152  000025   0708(1+S)  	CMPRS	A,TIMEG
   153  000026   8033(2)  	JMP		EXIT_INT
   154  000027   2B08(1)  	CLR		TIMEG
   155  000028   4805(1)  	BSET	READTM_FLAG
   156  000029   8033(2)  	JMP		EXIT_INT
   157  00002A             JUST_TC0:
   158  00002A   75C9(1+S)  	B0BTS0	FTC0IEN
   159  00002B   7DC8(1+S)  	B0BTS1	FTC0IRQ
   160  00002C   802F(2)  	JMP		JUST_INT0
   161  00002D   65C8(1)  	B0BCLR	FTC0IRQ
   162  00002E             ;TC0 INTERRUPT SERVICE PROGRESS
   163  00002E   8033(2)  	JMP		EXIT_INT
   164  00002F             JUST_INT0:
   165  00002F   70C9(1+S)  	B0BTS0	FP00IEN
   166  000030   78C8(1+S)  	B0BTS1	FP00IRQ
   167  000031   8033(2)  	JMP EXIT_INT
   168  000032   60C8(1)  	B0BCLR	FP00IRQ
   169  000033             ;INT0 INTERRUPT SERVISE PROGRESS
   170  000033             EXIT_INT:
   171  000033   0500(1)  	POP
   172  000034   0F00(2)  	RETI
   173  000035             ;*********************************************************
   174  000035             ;***********************STARRT**********************
   175  000035             START:
   176  000035   2D7F(1)  	MOV		A,#07FH
   177  000036   2FDF(1)  	B0MOV		STKP,A		;DISABLE GLOBAL INTERRUPT
   178  000037   2B86(1)  	CLR		PFLAG
   179  000038   2D00(1)  	MOV		A,#00H
   180  000039   2FCA(1)  	B0MOV		OSCM,A
   181  00003A   2D5A(1)  	MOV		A,#0X5A
   182  00003B   2FCC(1)  	B0MOV		WDTR,A	
   183  00003C   C1A2(2)  	CALL		CLRRAM
   184  00003D             STATE_INITIAL:
   185  00003D   C351(2)  	CALL		SYS_INIT_FUN
   186  00003E   67DF(1)  	B0BCLR		FGIE
   187  00003F             ;******************************************
   188  00003F   2D01(1)  	MOV		A,#DEFAULT_FRONT_TIME_DELAY
   189  000040   1F14(1)  	MOV		FRONT_DELAY,A
   190  000041   2D01(1)  	MOV		A,#DEFAULT_TIME_GAP
   191  000042   1F15(1)  	MOV		TIME_DELAY_GAP,A
   192  000043             ;////////////////////////////////
   193  000043   5606(1+S)  	BTS0		BLE_FLAG
   194  000044   8061(2)  	JMP			GET_INITIAL_DATA_FROM_EE
   195  000045             GET_TIME_INITIAL_TM:
   196  000045   6BD2(1)  	B0BSET	S_TM_EE_IO
   197  000046             ;Get initial time from tm
   198  000046   2D30(1)  	MOV		A,#TM_INITIAL_TIME_ADD_H
   199  000047   1F12(1)  	MOV		MAC_H,A
   200  000048   2D00(1)  	MOV		A,#TM_INITIAL_TIME_ADD_L
   201  000049   1F13(1)  	MOV		MAC_L,A
   202  00004A   C215(2)  	CALL	GET_DATA_FROM_TM_FUN
   203  00004B   1E0B(1)  	MOV		A,DATAH
   204  00004C   0600(1+S)  	CMPRS	A,#0X00
   205  00004D   1F18(1)  	MOV		INITIAL_TIMEH,A
   206  00004E   1E0C(1)  	MOV		A,DATAL
   207  00004F   0600(1+S)  	CMPRS	A,#0X00
   208  000050   1F19(1)  	MOV		INITIAL_TIMEL,A
   209  000051   C32D(2)  	CALL	DELAY_SHORT
   210  000052             ;GET TIME DELAY AND GAP FROM TM
   211  000052   2D31(1)  	MOV		A,#TM_TIME_H
   212  000053   1F12(1)  	MOV		MAC_H,A
   213  000054   2D00(1)  	MOV		A,#TM_TIME_L
   214  000055   1F13(1)  	MOV		MAC_L,A
   215  000056   C215(2)  	CALL	GET_DATA_FROM_TM_FUN
   216  000057             ;the 2bit in front of DATAH is useness
   217  000057   2D3F(1)  	MOV		A,#0X3F
   218  000058   290B(1)  	AND		DATAH,A
   219  000059   1E0B(1)  	MOV			A,DATAH
   220  00005A   0600(1+S)  	CMPRS		A,#0X00
   221  00005B   1F14(1)  	MOV			FRONT_DELAY,A
   222  00005C   1E0C(1)  	MOV			A,DATAL
   223  00005D   0600(1+S)  	CMPRS		A,#0X00
   224  00005E   1F15(1)  	MOV			TIME_DELAY_GAP,A		
   225  00005F   63D2(1)  	B0BCLR		S_TM_EE_IO
   226  000060   C333(2)  	CALL		DELAY_LONG
   227  000061             ;*******************************************
   228  000061             GET_INITIAL_DATA_FROM_EE:
   229  000061             ;*******************************************
   230  000061   2D1F(1)  	MOV			A,#LAST_TIME_EE_ADD_H
   231  000062   1F12(1)  	MOV			MAC_H,A
   232  000063   2DFE(1)  	MOV			A,#LAST_TIME_EE_ADD_L
   233  000064   1F13(1)  	MOV			MAC_L,A
   234  000065   5105(1+S)  	BTS0		RESET_FLAG
   235  000066   80CC(2)  	JMP			RESET_EEPROM
   236  000067   C274(2)  	CALL		GET_DATA_FROM_EE_FUN
   237  000068   1E0E(1)  	MOV			A,ADDRESSL
   238  000069   1F17(1)  	MOV			STARTADDRL,A
   239  00006A   1E0D(1)  	MOV			A,ADDRESSH
   240  00006B   1F16(1)  	MOV			STARTADDRH,A
   241  00006C   1E0D(1)  	MOV			A,ADDRESSH
   242  00006D   06FF(1+S)  	CMPRS		A,#0XFF
   243  00006E   8071(2)  	JMP			$+3
   244  00006F   2B16(1)  	CLR			STARTADDRH
   245  000070   2B17(1)  	CLR			STARTADDRL
   246  000071   C333(2)  	CALL		DELAY_LONG
   247  000072   2D1F(1)  	MOV			A,#LIVE_TIME_ADD_H
   248  000073   1F12(1)  	MOV			MAC_H,A
   249  000074   2DFC(1)  	MOV			A,#LIVE_TIME_ADD_L
   250  000075   1F13(1)  	MOV			MAC_L,A
   251  000076   1E16(1)  	MOV			A,STARTADDRH
   252  000077   1F0B(1)  	MOV			DATAH,A
   253  000078   1E17(1)  	MOV			A,STARTADDRL
   254  000079   1F0C(1)  	MOV			DATAL,A
   255  00007A   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   256  00007B             ;;;;;;;;;;;;;;LAST READ TM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
   257  00007B   6BD2(1)  	B0BSET		S_TM_EE_IO
   258  00007C   60D0(1)  	B0BCLR		VSR_IO
   259  00007D   2D34(1)  	MOV			A,#TM_DATA_H
   260  00007E   1F12(1)  	MOV			MAC_H,A
   261  00007F   2D00(1)  	MOV			A,#TM_DATA_L
   262  000080   1F13(1)  	MOV			MAC_L,A
   263  000081   C215(2)  	CALL		GET_DATA_FROM_TM_FUN
   264  000082   64D5(1)  	B0BCLR		VTM_IO
   265  000083   C32D(2)  	CALL		DELAY_SHORT
   266  000084   63D2(1)  	B0BCLR		S_TM_EE_IO
   267  000085   64C5(1)  	B0BCLR		VTM_CONT
   268  000086             ;////////////////////READ BLE INITIAL TIME /////////////////
   269  000086   5E06(1+S)  	BTS1		BLE_FLAG
   270  000087   80B5(2)  	JMP			WRITE_INITIAL_DATA_TO_EE
   271  000088             GET_INITIAL_TIME_FROM_EE:
   272  000088   C32D(2)  	CALL		DELAY_SHORT
   273  000089   2D1F(1)  	MOV		A,#EE_INITIAL_TIME_ADD_H
   274  00008A   1F12(1)  	MOV		MAC_H,A
   275  00008B   2DFA(1)  	MOV		A,#EE_INITIAL_TIME_ADD_L
   276  00008C   1F13(1)  	MOV		MAC_L,A
   277  00008D   C274(2)  	CALL		GET_DATA_FROM_EE_FUN
   278  00008E   1E0D(1)  	MOV		A,ADDRESSH
   279  00008F   1F18(1)  	MOV		INITIAL_TIMEH,A
   280  000090   1E0E(1)  	MOV		A,ADDRESSL
   281  000091   1F19(1)  	MOV		INITIAL_TIMEL,A
   282  000092   C333(2)  	CALL	DELAY_LONG
   283  000093   2D1F(1)  	MOV		A,#EE_DELAY_ADD_H
   284  000094   1F12(1)  	MOV		MAC_H,A
   285  000095   2DF8(1)  	MOV		A,#EE_GAP_ADD_L
   286  000096   1F13(1)  	MOV		MAC_L,A
   287  000097   C274(2)  	CALL		GET_DATA_FROM_EE_FUN
   288  000098   1E0D(1)  	MOV		A,ADDRESSH
   289  000099   1F14(1)  	MOV		FRONT_DELAY,A
   290  00009A   1E0E(1)  	MOV		A,ADDRESSL
   291  00009B   1F15(1)  	MOV		TIME_DELAY_GAP,A
   292  00009C   C333(2)  	CALL	DELAY_LONG
   293  00009D             ;/////////////////WRITE TO TM//////////////////////////////
   294  00009D             WRITE_INITIAL_DATA_TO_TM:
   295  00009D   6BD2(1)  	B0BSET	S_TM_EE_IO
   296  00009E             ;PUT initial time TO tm
   297  00009E   2D30(1)  	MOV		A,#TM_INITIAL_TIME_ADD_H
   298  00009F   1F12(1)  	MOV		MAC_H,A
   299  0000A0   2D00(1)  	MOV		A,#TM_INITIAL_TIME_ADD_L
   300  0000A1   1F13(1)  	MOV		MAC_L,A
   301  0000A2   1E18(1)  	MOV		A,INITIAL_TIMEH
   302  0000A3   1F0B(1)  	MOV		DATAH,A
   303  0000A4   1E19(1)  	MOV		A,INITIAL_TIMEL
   304  0000A5   1F0C(1)  	MOV		DATAL,A
   305  0000A6   C1CD(2)  	CALL	PUT_DATA_INTO_TM_FUN
   306  0000A7             ;PUT TIME DELAY AND GAP TO TM
   307  0000A7   2D31(1)  	MOV		A,#TM_TIME_H
   308  0000A8   1F12(1)  	MOV		MAC_H,A
   309  0000A9   2D00(1)  	MOV		A,#TM_TIME_L
   310  0000AA   1F13(1)  	MOV		MAC_L,A
   311  0000AB             ;the 2bit in front of DATAH is useness
   312  0000AB   2D3F(1)  	MOV		A,#0X3F
   313  0000AC   2814(1)  	AND		A,FRONT_DELAY
   314  0000AD   1F0B(1)  	MOV		DATAH,A
   315  0000AE   1E15(1)  	MOV		A,TIME_DELAY_GAP
   316  0000AF   1F0C(1)  	MOV		DATAL,A	
   317  0000B0   C1CD(2)  	CALL	PUT_DATA_INTO_TM_FUN
   318  0000B1             ;the 2bit in front of DATAH is useness
   319  0000B1   63D2(1)  	B0BCLR		S_TM_EE_IO
   320  0000B2   C333(2)  	CALL		DELAY_LONG
   321  0000B3             ;///////////////////////////////
   322  0000B3   5606(1+S)  	BTS0	BLE_FLAG
   323  0000B4   80CA(2)  	JMP		SET_WRITE_EE_START_ADD
   324  0000B5             ;/////////////////WRITE TO EE//////////////////////////////
   325  0000B5             WRITE_INITIAL_DATA_TO_EE:
   326  0000B5             ;///////////INITIAL TIME/////////////////////
   327  0000B5   C32D(2)  	CALL		DELAY_SHORT
   328  0000B6   2D1F(1)  	MOV		A,#EE_INITIAL_TIME_ADD_H
   329  0000B7   1F12(1)  	MOV		MAC_H,A
   330  0000B8   2DFA(1)  	MOV		A,#EE_INITIAL_TIME_ADD_L
   331  0000B9   1F13(1)  	MOV		MAC_L,A
   332  0000BA   1E18(1)  	MOV		A,INITIAL_TIMEH
   333  0000BB   1F0B(1)  	MOV		DATAH,A
   334  0000BC   1E19(1)  	MOV		A,INITIAL_TIMEL
   335  0000BD   1F0C(1)  	MOV		DATAL,A
   336  0000BE   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   337  0000BF   C333(2)  	CALL	DELAY_LONG
   338  0000C0   2D1F(1)  	MOV		A,#EE_DELAY_ADD_H
   339  0000C1   1F12(1)  	MOV		MAC_H,A
   340  0000C2   2DF8(1)  	MOV		A,#EE_GAP_ADD_L
   341  0000C3   1F13(1)  	MOV		MAC_L,A
   342  0000C4   1E14(1)  	MOV		A,FRONT_DELAY
   343  0000C5   1F0B(1)  	MOV		DATAH,A
   344  0000C6   1E15(1)  	MOV		A,TIME_DELAY_GAP
   345  0000C7   1F0C(1)  	MOV		DATAL,A
   346  0000C8   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   347  0000C9   C333(2)  	CALL	DELAY_LONG
   348  0000CA             
   349  0000CA             
   350  0000CA             SET_WRITE_EE_START_ADD:
   351  0000CA             	
   352  0000CA   5905(1+S)  	BTS1		RESET_FLAG
   353  0000CB   80EC(2)  	JMP			FRONT_DELAY_MODE
   354  0000CC             RESET_EEPROM:
   355  0000CC   2DFF(1)  	MOV		A,#0XFF
   356  0000CD   1F0B(1)  	MOV		DATAH,A
   357  0000CE   2DFF(1)  	MOV		A,#0XFF
   358  0000CF   1F0C(1)  	MOV		DATAL,A
   359  0000D0   2D00(1)  	MOV		A,#0X00
   360  0000D1   1F12(1)  	MOV		MAC_H,A
   361  0000D2             RESET_EE_LOOP_H:
   362  0000D2   2D00(1)  	MOV		A,#0X00
   363  0000D3   1F13(1)  	MOV		MAC_L,A
   364  0000D4             RESET_EE_LOOP_L:
   365  0000D4   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   366  0000D5   1613(1+S)  	INCMS	MAC_L
   367  0000D6   80D4(2)  	JMP		RESET_EE_LOOP_L
   368  0000D7   1612(1+S)  	INCMS	MAC_H
   369  0000D8   1E12(1)  	MOV		A,MAC_H
   370  0000D9   0620(1+S)  	CMPRS	A,#0X20
   371  0000DA   80D2(2)  	JMP		RESET_EE_LOOP_H
   372  0000DB   2B16(1)  	CLR		STARTADDRH
   373  0000DC   2B17(1)  	CLR		STARTADDRL
   374  0000DD   2D1F(1)  	MOV		A,#LAST_TIME_EE_ADD_H
   375  0000DE   1F12(1)  	MOV		MAC_H,A
   376  0000DF   2DFE(1)  	MOV		A,#LAST_TIME_EE_ADD_L
   377  0000E0   1F13(1)  	MOV		MAC_L,A
   378  0000E1   1E16(1)  	MOV		A,STARTADDRH
   379  0000E2   1F0B(1)  	MOV		DATAH,A
   380  0000E3   1E17(1)  	MOV		A,STARTADDRL
   381  0000E4   1F0C(1)  	MOV		DATAL,A
   382  0000E5   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   383  0000E6   2D1F(1)  	MOV			A,#LIVE_TIME_ADD_H
   384  0000E7   1F12(1)  	MOV			MAC_H,A
   385  0000E8   2DFC(1)  	MOV			A,#LIVE_TIME_ADD_L
   386  0000E9   1F13(1)  	MOV			MAC_L,A
   387  0000EA   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   388  0000EB   4105(1)  	BCLR		RESET_FLAG
   389  0000EC             ;******************************************
   390  0000EC             FRONT_DELAY_MODE:
   391  0000EC   6FDF(1)  	B0BSET		FGIE
   392  0000ED   C387(2)  	CALL		SET_LOW_POWER_FUN
   393  0000EE             ;DELAY WAIT_FOR_SEAVAL_MINITE_FUN
   394  0000EE             ;/////////////////////////////////////////	
   395  0000EE   1E14(1)  	MOV   	A,FRONT_DELAY
   396  0000EF   1F0F(1)  	MOV		CRCT1,A
   397  0000F0             FRONT_DELAY_LOOP:
   398  0000F0             	GreenMode
   399  0000F0   6CCA(1)  		B0BSET	FCPUM1
   400  0000F1   0000(1)  		NOP
   401  0000F2   0000(1)  		NOP
   402  0000F3   5406(1+S)  	BTS0	NOT_QUICK_MODE_FLAG
   403  0000F4   C37E(2)  	CALL	SET_EE_TM_FUN
   404  0000F5   5206(1+S)  	BTS0	NOT_UPLOAD_FLAG
   405  0000F6   C387(2)  	CALL	SET_LOW_POWER_FUN
   406  0000F7   5B05(1+S)  	BTS1	TIME_FLAG
   407  0000F8   80F0(2)  	JMP		FRONT_DELAY_LOOP
   408  0000F9   4305(1)  	BCLR	TIME_FLAG
   409  0000FA   260F(1+S)  	DECMS	CRCT1
   410  0000FB   80F0(2)  	JMP		FRONT_DELAY_LOOP
   411  0000FC             	;///////////////////////////
   412  0000FC   4206(1)  	BCLR		NOT_UPLOAD_FLAG
   413  0000FD   4306(1)  	BCLR		HAVE_UPLOAD_FLAG
   414  0000FE   4606(1)  	BCLR		BLE_FLAG
   415  0000FF             ;//////////////////////////////////////
   416  0000FF             MAIN:
   417  0000FF             	;close tc0 interrupt until the recording finished 
   418  0000FF             	GreenMode
   419  0000FF   6CCA(1)  		B0BSET	FCPUM1
   420  000100   0000(1)  		NOP
   421  000101   0000(1)  		NOP
   422  000102             	
   423  000102             JUST_I2CSLAVE_MODE:
   424  000102   5805(1+S)  	BTS1	READTM_FLAG
   425  000103   8160(2)  	JMP		JUST_UPLOAD_MODE
   426  000104   5505(1+S)  	BTS0	FILLOUT_FLAG
   427  000105   817E(2)  	JMP		MEM_FILLOUT_MODE
   428  000106   7CC9(1+S)  	B0BTS1	FT0IEN
   429  000107   8160(2)  	JMP		JUST_UPLOAD_MODE
   430  000108             ;*****START TM I2C SLAVE MODE***********
   431  000108             I2CSLAVE_MODE:
   432  000108   4005(1)  	BCLR 	READTM_FLAG
   433  000109   59D1(1+S)  	BTS1	VDDF
   434  00010A   8152(2)  	JMP		ADDRESS_CHANGE
   435  00010B   5CD2(1+S)  	BTS1	BLEF
   436  00010C   8152(2)  	JMP		ADDRESS_CHANGE
   437  00010D   4606(1)  	BCLR	BLE_FLAG
   438  00010E   67DF(1)  	B0BCLR 	FGIE
   439  00010F   6CC5(1)  	B0BSET	VTM_CONT
   440  000110   6BD2(1)  	B0BSET	S_TM_EE_IO
   441  000111   60D0(1)  	B0BCLR	VSR_IO
   442  000112   2D34(1)  	MOV		A,#TM_DATA_H
   443  000113   1F12(1)  	MOV		MAC_H,A
   444  000114   2D00(1)  	MOV		A,#TM_DATA_L
   445  000115   1F13(1)  	MOV		MAC_L,A
   446  000116   C215(2)  	CALL	GET_DATA_FROM_TM_FUN
   447  000117   64D5(1)  	B0BCLR		VTM_IO
   448  000118   C32D(2)  	CALL		DELAY_SHORT
   449  000119   63D2(1)  	B0BCLR		S_TM_EE_IO
   450  00011A   64C5(1)  	B0BCLR		VTM_CONT
   451  00011B   C32D(2)  	CALL		DELAY_SHORT
   452  00011C   1E16(1)  	MOV		A,STARTADDRH
   453  00011D   1F12(1)  	MOV		MAC_H,A
   454  00011E   1E17(1)  	MOV		A,STARTADDRL
   455  00011F   1F13(1)  	MOV		MAC_L,A
   456  000120   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   457  000121             ;compare temperature is over the set level
   458  000121   4706(1)  	BCLR		TMP_LEVEL_FLAG
   459  000122   1E0B(1)  	MOV			A,DATAH
   460  000123   1F1A(1)  	MOV			TEMPERATURE_H,A
   461  000124   2D1F(1)  	MOV			A,#TMP_LEVEL_ADDH
   462  000125   1F12(1)  	MOV			MAC_H,A
   463  000126   2DF0(1)  	MOV			A,#TMP_LEVEL_ADDL
   464  000127   1F13(1)  	MOV			MAC_L,A
   465  000128   C274(2)  	CALL		GET_DATA_FROM_EE_FUN
   466  000129   1E0D(1)  	MOV			A,ADDRESSH
   467  00012A   06FF(1+S)  	CMPRS		A,#0XFF
   468  00012B   2D20(1)  	MOV			A,#HIGT_TMP_LEVEL1
   469  00012C   221A(1)  	SUB			A,TEMPERATURE_H
   470  00012D   7A86(1+S)  	B0BTS1		FC
   471  00012E   4F06(1)  	BSET		TMP_LEVEL_FLAG
   472  00012F   1E0E(1)  	MOV			A,ADDRESSL
   473  000130   06FF(1+S)  	CMPRS		A,#0XFF
   474  000131   2D05(1)  	MOV			A,#LOW_TMP_LEVEL1
   475  000132   221A(1)  	SUB			A,TEMPERATURE_H
   476  000133   7286(1+S)  	B0BTS0		FC
   477  000134   4F06(1)  	BSET		TMP_LEVEL_FLAG
   478  000135             ;////////////////////////////////////////
   479  000135   2D1F(1)  	MOV		A,#LAST_TIME_EE_ADD_H
   480  000136   1F12(1)  	MOV		MAC_H,A
   481  000137   2DFE(1)  	MOV		A,#LAST_TIME_EE_ADD_L
   482  000138   1F13(1)  	MOV		MAC_L,A
   483  000139   1E16(1)  	MOV		A,STARTADDRH
   484  00013A   1F0B(1)  	MOV		DATAH,A
   485  00013B   1E17(1)  	MOV		A,STARTADDRL
   486  00013C   1F0C(1)  	MOV		DATAL,A
   487  00013D   C1AA(2)  	CALL		DATA_TO_EEPROM_FUN
   488  00013E   74C8(1+S)  	B0BTS0		FT0IRQ
   489  00013F   1607(1+S)  	INCMS		TIMEH
   490  000140   64C8(1)  	B0BCLR		FT0IRQ
   491  000141   6FDF(1)  	B0BSET		FGIE
   492  000142   2D0A(1)  	MOV			A,#TIME_GAP
   493  000143   1F10(1)  	MOV			CRCT2,A
   494  000144   6286(1)  	B0BCLR		FC
   495  000145   5706(1+S)  	BTS0		TMP_LEVEL_FLAG
   496  000146   0910(1)  	RRCM		CRCT2
   497  000147   1E10(1)  	MOV			A,CRCT2
   498  000148   0707(1+S)  	CMPRS		A,TIMEH
   499  000149   8152(2)  	JMP			ADDRESS_CHANGE
   500  00014A   2B07(1)  	CLR			TIMEH
   501  00014B   4B05(1)  	BSET		TIME_FLAG
   502  00014C   1608(1+S)  	INCMS		TIMEG
   503  00014D   1E15(1)  	MOV			A,TIME_DELAY_GAP
   504  00014E   0708(1+S)  	CMPRS		A,TIMEG
   505  00014F   8152(2)  	JMP			ADDRESS_CHANGE
   506  000150   2B08(1)  	CLR			TIMEG
   507  000151   4805(1)  	BSET		READTM_FLAG
   508  000152             ADDRESS_CHANGE:
   509  000152   2D02(1)  	MOV			A,#0X02
   510  000153   1317(1)  	ADD			STARTADDRL,A
   511  000154   2D00(1)  	MOV			A,#0X00
   512  000155   1116(1)  	ADC			STARTADDRH,A
   513  000156   2D1F(1)  	MOV			A,#MAX_MEMH
   514  000157   0716(1+S)  	CMPRS		A,STARTADDRH
   515  000158   8102(2)  	JMP			JUST_I2CSLAVE_MODE
   516  000159   2DDE(1)  	MOV			A,#MAX_MEML
   517  00015A   0717(1+S)  	CMPRS		A,STARTADDRL
   518  00015B   8102(2)  	JMP			JUST_I2CSLAVE_MODE
   519  00015C   4D05(1)  	BSET		FILLOUT_FLAG
   520  00015D   67D8(1)  	B0BCLR		FT0ENB
   521  00015E   64C9(1)  	B0BCLR		FT0IEN
   522  00015F   817E(2)  	JMP			MEM_FILLOUT_MODE
   523  000160             ;*****************************************
   524  000160             JUST_UPLOAD_MODE:
   525  000160   62C2(1)  	B0BCLR		CLED_CONT
   526  000161   C32D(2)  	CALL		DELAY_SHORT
   527  000162   C32D(2)  	CALL		DELAY_SHORT
   528  000163   7AD2(1+S)  	B0BTS1		CLED_IO
   529  000164   8194(2)  	JMP			RESET_MODE
   530  000165             BLE_EE_UPLOAD_MODE:
   531  000165   5606(1+S)  	BTS0		BLE_FLAG
   532  000166   816C(2)  	JMP			END_BLE_EE_MODE
   533  000167   54D2(1+S)  	BTS0		BLEF
   534  000168   8170(2)  	JMP			TM_EE_UPLOAD_MODE
   535  000169   4E06(1)  	BSET		BLE_FLAG
   536  00016A   C387(2)  	CALL		SET_LOW_POWER_FUN
   537  00016B   817E(2)  	JMP			MEM_FILLOUT_MODE
   538  00016C             END_BLE_EE_MODE:
   539  00016C   5CD2(1+S)  	BTS1		BLEF
   540  00016D   817E(2)  	JMP			MEM_FILLOUT_MODE
   541  00016E   C387(2)  	CALL		SET_LOW_POWER_FUN
   542  00016F   4606(1)  	BCLR		BLE_FLAG
   543  000170             TM_EE_UPLOAD_MODE:
   544  000170   5205(1+S)  	BTS0		TM_EE_FLAG
   545  000171   8178(2)  	JMP			END_TM_EE_MODE
   546  000172   51D1(1+S)  	BTS0		VDDF
   547  000173   817E(2)  	JMP			MEM_FILLOUT_MODE
   548  000174             TM_EE_MODE:
   549  000174   4306(1)  	BCLR		HAVE_UPLOAD_FLAG
   550  000175   5205(1+S)  	BTS0		TM_EE_FLAG
   551  000176   8178(2)  	JMP			END_TM_EE_MODE
   552  000177   C37E(2)  	CALL		SET_EE_TM_FUN
   553  000178             END_TM_EE_MODE:
   554  000178             	;BTS0		FILLOUT_FLAG
   555  000178             	;JMP			MEM_FILLOUT_MODE	
   556  000178   59D1(1+S)  	BTS1		VDDF
   557  000179   817E(2)  	JMP			MEM_FILLOUT_MODE
   558  00017A   C387(2)  	CALL		SET_LOW_POWER_FUN
   559  00017B   5505(1+S)  	BTS0		FILLOUT_FLAG
   560  00017C   817E(2)  	JMP			MEM_FILLOUT_MODE
   561  00017D             	;we should keep rtc function 
   562  00017D   818B(2)  	JMP		ON_LED_MODE
   563  00017E             ;*************************************
   564  00017E             MEM_FILLOUT_MODE:
   565  00017E   5D05(1+S)  	BTS1	FILLOUT_FLAG
   566  00017F   818B(2)  	JMP		ON_LED_MODE
   567  000180             ;***************************
   568  000180             	;B0BTS1	VDDF
   569  000180             	;JMP		$+4
   570  000180             	;BTS0	TM_EE_FLAG
   571  000180             	;CALL	SET_LOW_POWER_FUN
   572  000180             	;JMP		$+3
   573  000180             	;BTS1	TM_EE_FLAG
   574  000180             	;CALL	SET_EE_TM_FUN
   575  000180             ;********************************
   576  000180   7FD8(1+S)  	B0BTS1		FT0ENB
   577  000181   8185(2)  	JMP			$+4
   578  000182   2BD9(1)  	CLR			T0C
   579  000183   64C8(1)  	B0BCLR		FT0IRQ
   580  000184   64C9(1)  	B0BCLR		FT0IEN
   581  000185   67D8(1)  	B0BCLR		FT0ENB
   582  000186             	SleepMode
   583  000186   6BCA(1)  		B0BSET	FCPUM0
   584  000187             END_FILLOUT_MODE:
   585  000187   6AC2(1)  	B0BSET		CLED_CONT
   586  000188   6AD2(1)  	B0BSET		CLED_IO
   587  000189   C328(2)  	CALL		DELAY_MINI
   588  00018A   8160(2)  	JMP		JUST_UPLOAD_MODE
   589  00018B             ON_LED_MODE:
   590  00018B   6AC2(1)  	B0BSET	CLED_CONT
   591  00018C   6AD2(1)  	B0BSET	CLED_IO
   592  00018D   5106(1+S)  	BTS0	READ_LED_FLAG
   593  00018E   C199(2)  	CALL	READ_LED_FUN
   594  00018F   4106(1)  	BCLR   	READ_LED_FLAG
   595  000190   6AD2(1)  	B0BSET	CLED_IO
   596  000191   5505(1+S)  	BTS0	FILLOUT_FLAG
   597  000192   8160(2)  	JMP		JUST_UPLOAD_MODE
   598  000193   80FF(2)  	JMP		MAIN
   599  000194             RESET_MODE:
   600  000194   4905(1)  	BSET	RESET_FLAG
   601  000195   4505(1)  	BCLR	FILLOUT_FLAG
   602  000196   2B07(1)  	CLR		TIMEH
   603  000197   2B08(1)  	CLR		TIMEG
   604  000198   803D(2)  	JMP		STATE_INITIAL
   605  000199             	
   606  000199             ;******************************************************************************	
   607  000199             READ_LED_FUN:
   608  000199   2D01(1)     	MOV  	   	A,#1
   609  00019A   1F04(1)     	MOV  	   	TLC2,A
   610  00019B             LED_MODEL1:	
   611  00019B   6AD2(1)     	B0BSET   	CLED_IO
   612  00019C   C33D(2)     	CALL   	   	DELAY_LED
   613  00019D   62D2(1)     	B0BCLR   	CLED_IO
   614  00019E   C33D(2)     	CALL   	   	DELAY_LED
   615  00019F   2604(1+S)     	DECMS   	TLC2
   616  0001A0   819B(2)     	JMP   	   	LED_MODEL1
   617  0001A1   0E00(2)     	RET
   618  0001A2             ;*******************************************************
   619  0001A2             ;***************************************
   620  0001A2             	
   621  0001A2             	
   622  0001A2             	
   623  0001A2             	
   624  0001A2             	
   625  0001A2             	
   626  0001A2             	
   627  0001A2             	
   628  0001A2             	
   629  0001A2             	
   630  0001A2             	
   631  0001A2             	
   632  0001A2             	
   633  0001A2             	
   634  0001A2             	
   635  0001A2             	
   636  0001A2             CLRRAM:
   637  0001A2             	
   638  0001A2   2B84(1)  	CLR			Y
   639  0001A3   2D2F(1)  	MOV			A,#END_RAM_ADDR
   640  0001A4   2F83(1)  	B0MOV		Z,A
   641  0001A5             CLRRAM10:
   642  0001A5   2BE7(1)  	CLR			@YZ
   643  0001A6   2683(1+S)  	DECMS		Z
   644  0001A7   81A5(2)  	JMP			CLRRAM10
   645  0001A8   2BE7(1)  	CLR			@YZ
   646  0001A9   0E00(2)  	RET
   647  0001AA             ;***********************************
   648  0001AA             ;***************************************
   649  0001AA             ;*************WRITE TMEPERATURE INTO EEPROM*************
   650  0001AA             ;*************RECORDING ADDRESS THE LAST TIME STORAGE THE TMPERATURE VALUE************
   651  0001AA             ;**************************************
   652  0001AA             DATA_TO_EEPROM_FUN:
   653  0001AA   6DC2(1)  	B0BSET		SDA_CONT
   654  0001AB   6DD2(1)  	B0BSET		SDA_IO
   655  0001AC   68C2(1)  	B0BSET		SCL_CONT
   656  0001AD   68D2(1)  	B0BSET		SCL_IO
   657  0001AE   1E13(1)  	MOV			A,MAC_L
   658  0001AF   1F10(1)  	MOV			CRCT2,A
   659  0001B0   1E0B(1)  	MOV			A,DATAH
   660  0001B1   1F0F(1)  	MOV			CRCT1,A
   661  0001B2   2D02(1)  	MOV			A,#0X02
   662  0001B3   1F04(1)  	MOV			TLC2,A
   663  0001B4             MOVE_DATA_TO_EEPROM:
   664  0001B4   C2A0(2)  	CALL		I2C_START_EE
   665  0001B5   2DA0(1)  	MOV			A,#EEW_ADD
   666  0001B6   1F09(1)  	MOV			DATA_IN,A
   667  0001B7   C2F1(2)  	CALL		EEADDRESS_ASK
   668  0001B8   1E12(1)  	MOV			A,MAC_H
   669  0001B9   1F09(1)  	MOV			DATA_IN,A
   670  0001BA   C2F1(2)  	CALL		EEADDRESS_ASK
   671  0001BB   1E10(1)  	MOV			A,CRCT2
   672  0001BC   1F09(1)  	MOV			DATA_IN,A
   673  0001BD   C2F1(2)  	CALL		EEADDRESS_ASK
   674  0001BE   C328(2)  	CALL		DELAY_MINI
   675  0001BF   1E0F(1)  	MOV			A,CRCT1
   676  0001C0   1F09(1)  	MOV			DATA_IN,A
   677  0001C1   C2F1(2)  	CALL		EEADDRESS_ASK
   678  0001C2   C2A6(2)  	CALL		I2C_END_EE
   679  0001C3             	
   680  0001C3   C333(2)  	CALL		DELAY_LONG
   681  0001C4   2D01(1)  	MOV			A,#0X01
   682  0001C5   1310(1)  	ADD			CRCT2,A
   683  0001C6   1E0C(1)  	MOV			A,DATAL
   684  0001C7   1F0F(1)  	MOV			CRCT1,A
   685  0001C8   2604(1+S)  	DECMS		TLC2
   686  0001C9   81B4(2)  	JMP			MOVE_DATA_TO_EEPROM
   687  0001CA             ;*********************************************
   688  0001CA   60C2(1)  	B0BCLR		SCL_CONT
   689  0001CB   65C2(1)  	B0BCLR		SDA_CONT
   690  0001CC   0E00(2)  	RET
   691  0001CD             ;**************************************
   692  0001CD             PUT_DATA_INTO_TM_FUN:
   693  0001CD   68C2(1)  	B0BSET	SCL_CONT
   694  0001CE   69C2(1)  	B0BSET	SDATA_CONT
   695  0001CF   61D2(1)  	B0BCLR	SDATA_IO
   696  0001D0   60D2(1)  	B0BCLR	SCL_IO
   697  0001D1   C333(2)  	CALL 	DELAY_LONG
   698  0001D2   C333(2)  	CALL 	DELAY_LONG
   699  0001D3   6CD5(1)  	B0BSET 	VTM_IO
   700  0001D4   C333(2)  	CALL 	DELAY_LONG
   701  0001D5             	;CALL	DELAY_LONG
   702  0001D5             START_TMI2C_S:
   703  0001D5   2D04(1)  	MOV 	A,#0X04
   704  0001D6   1F03(1)  	MOV 	TLC0,A
   705  0001D7             LOOP_1_S:
   706  0001D7   68D2(1)  	B0BSET 	SCL_IO
   707  0001D8   C328(2)  	CALL	DELAY_MINI;13US
   708  0001D9   C327(2)  	CALL	CALL_DELAY
   709  0001DA   60D2(1)  	B0BCLR 	SCL_IO
   710  0001DB   C328(2)  	CALL 	DELAY_MINI
   711  0001DC   2603(1+S)  	DECMS  	TLC0
   712  0001DD   81D7(2)  	JMP 	LOOP_1_S
   713  0001DE   41D2(1)  	BCLR 	SDATA_IO
   714  0001DF   C333(2)  	CALL	DELAY_LONG
   715  0001E0   C333(2)  	CALL	DELAY_LONG
   716  0001E1   2D04(1)  	MOV 	A,#4
   717  0001E2   2F03(1)  	B0MOV 	TLC0,A
   718  0001E3             LOOP_2_S:
   719  0001E3   60D2(1)  	B0BCLR 	SCL_IO
   720  0001E4   C328(2)  	CALL	DELAY_MINI
   721  0001E5   C327(2)  	CALL	CALL_DELAY
   722  0001E6   68D2(1)  	B0BSET 	SCL_IO
   723  0001E7   C328(2)  	CALL	DELAY_MINI
   724  0001E8   2603(1+S)  	DECMS 	TLC0
   725  0001E9   81E3(2)  	JMP 	LOOP_2_S
   726  0001EA   C32D(2)  	CALL	DELAY_SHORT
   727  0001EB   2D14(1)  	MOV 	A,#20
   728  0001EC   2F03(1)  	B0MOV 	TLC0,A
   729  0001ED   49D2(1)  	BSET 	SDATA_IO
   730  0001EE             WAIT_TM_INIT_S:
   731  0001EE   C333(2)  	CALL 		DELAY_LONG
   732  0001EF   2603(1+S)  	DECMS 		TLC0
   733  0001F0   81EE(2)  	JMP 		WAIT_TM_INIT_S
   734  0001F1             ;**************START*****************************
   735  0001F1   C2AD(2)  	CALL		I2C_START_TM
   736  0001F2             ;***********************************************
   737  0001F2   2D3C(1)  	MOV 		A,#TMW_ADD
   738  0001F3   1F09(1)  	MOV 		DATA_IN,A
   739  0001F4   C2BB(2)  	CALL 		TMADDRESS_ASK
   740  0001F5   5506(1+S)  	BTS0		TM_I2C_EEROR
   741  0001F6   820F(2)  	JMP			END_TM_S
   742  0001F7   1E12(1)  	MOV 		A,MAC_H
   743  0001F8   1F09(1)  	MOV 		DATA_IN,A
   744  0001F9   C2BB(2)  	CALL 		TMADDRESS_ASK
   745  0001FA   1E13(1)  	MOV 		A,MAC_L
   746  0001FB   1F09(1)  	MOV 		DATA_IN,A
   747  0001FC   C2BB(2)  	CALL 		TMADDRESS_ASK
   748  0001FD   C333(2)  	CALL		DELAY_LONG
   749  0001FE   1E0B(1)  	MOV 		A,DATAH
   750  0001FF   1F09(1)  	MOV 		DATA_IN,A
   751  000200   C2BB(2)  	CALL 		TMADDRESS_ASK
   752  000201   1E0C(1)  	MOV 		A,DATAL
   753  000202   1F09(1)  	MOV 		DATA_IN,A
   754  000203   C2BB(2)  	CALL 		TMADDRESS_ASK
   755  000204   C32D(2)  	CALL		DELAY_SHORT
   756  000205             ;**************END*******************************
   757  000205             ;//////////////////////DEBUG////////////////////
   758  000205   C2B3(2)  	CALL		I2C_END_TM
   759  000206   C333(2)  	CALL		DELAY_LONG
   760  000207   C2AD(2)  	CALL		I2C_START_TM
   761  000208             ;***********************************************
   762  000208   2D3C(1)  	MOV 		A,#0X3C
   763  000209   1F09(1)  	MOV 		DATA_IN,A
   764  00020A   C2BB(2)  	CALL 		TMADDRESS_ASK
   765  00020B             ;**************END*******************************
   766  00020B   C2B3(2)  	CALL		I2C_END_TM
   767  00020C   C333(2)  	CALL		DELAY_LONG
   768  00020D   C333(2)  	CALL		DELAY_LONG
   769  00020E   61D2(1)  	B0BCLR		SDATA_IO
   770  00020F             END_TM_S:
   771  00020F   4506(1)  	BCLR		TM_I2C_EEROR
   772  000210   64D5(1)  	B0BCLR 		VTM_IO
   773  000211   61C2(1)  	B0BCLR		SDATA_CONT
   774  000212   60C2(1)  	B0BCLR		SCL_CONT
   775  000213   C32D(2)  	CALL 		DELAY_SHORT
   776  000214   0E00(2)  	RET
   777  000215             ;*******************************************
   778  000215             ;*****************************************
   779  000215             GET_DATA_FROM_TM_FUN:
   780  000215   2D0F(1)  	MOV		A,#0X0F
   781  000216   1F11(1)  	MOV		COUNT,A
   782  000217             TM_I2C_WORK_LOOP:
   783  000217   68C2(1)  	B0BSET	SCL_CONT
   784  000218   69C2(1)  	B0BSET	SDATA_CONT
   785  000219   61D2(1)  	B0BCLR	SDATA_IO
   786  00021A   60D2(1)  	B0BCLR	SCL_IO
   787  00021B   C333(2)  	CALL 	DELAY_LONG
   788  00021C   C333(2)  	CALL 	DELAY_LONG
   789  00021D   6CD5(1)  	B0BSET 	VTM_IO
   790  00021E   C333(2)  	CALL 	DELAY_LONG
   791  00021F             	;CALL	DELAY_LONG
   792  00021F             START_TMI2C:
   793  00021F   2D04(1)  	MOV 	A,#0X04
   794  000220   1F03(1)  	MOV 	TLC0,A
   795  000221             LOOP_1:
   796  000221   68D2(1)  	B0BSET 	SCL_IO
   797  000222   C328(2)  	CALL	DELAY_MINI;13US
   798  000223   C327(2)  	CALL	CALL_DELAY
   799  000224   60D2(1)  	B0BCLR 	SCL_IO
   800  000225   C328(2)  	CALL 	DELAY_MINI
   801  000226   2603(1+S)  	DECMS  	TLC0
   802  000227   8221(2)  	JMP 	LOOP_1
   803  000228   2D28(1)  	MOV 	A,#40
   804  000229   2F03(1)  	B0MOV 	TLC0,A
   805  00022A   41D2(1)  	BCLR 	SDATA_IO
   806  00022B   C333(2)  	CALL	DELAY_LONG
   807  00022C             	;CALL	DELAY_SHORT
   808  00022C   2D04(1)  	MOV 	A,#4
   809  00022D   2F03(1)  	B0MOV 	TLC0,A
   810  00022E             LOOP_2:
   811  00022E   60D2(1)  	B0BCLR 	SCL_IO
   812  00022F   C328(2)  	CALL	DELAY_MINI
   813  000230   C327(2)  	CALL	CALL_DELAY
   814  000231   68D2(1)  	B0BSET 	SCL_IO
   815  000232   C328(2)  	CALL	DELAY_MINI
   816  000233   2603(1+S)  	DECMS 	TLC0
   817  000234   822E(2)  	JMP 	LOOP_2
   818  000235   C32D(2)  	CALL	DELAY_SHORT
   819  000236   2D05(1)  	MOV 	A,#5
   820  000237   2F03(1)  	B0MOV 	TLC0,A
   821  000238   49D2(1)  	BSET 	SDATA_IO
   822  000239             WAIT_TM_INIT:
   823  000239   C333(2)  	CALL 		DELAY_LONG
   824  00023A   2603(1+S)  	DECMS 		TLC0
   825  00023B   8239(2)  	JMP 		WAIT_TM_INIT
   826  00023C             ;**************START*****************************
   827  00023C   C2AD(2)  	CALL		I2C_START_TM
   828  00023D             ;***********************************************
   829  00023D   2D3D(1)  	MOV 		A,#TMR_ADD
   830  00023E   1F09(1)  	MOV 		DATA_IN,A
   831  00023F   C2BB(2)  	CALL 		TMADDRESS_ASK
   832  000240   5506(1+S)  	BTS0		TM_I2C_EEROR
   833  000241   8266(2)  	JMP			END_TM
   834  000242   1E12(1)  	MOV 		A,MAC_H
   835  000243   1F09(1)  	MOV 		DATA_IN,A
   836  000244   C2BB(2)  	CALL 		TMADDRESS_ASK
   837  000245   1E13(1)  	MOV 		A,MAC_L
   838  000246   1F09(1)  	MOV 		DATA_IN,A
   839  000247   C2BB(2)  	CALL 		TMADDRESS_ASK
   840  000248   61C2(1)  	B0BCLR		SDATA_CONT
   841  000249   C333(2)  	CALL 		DELAY_LONG
   842  00024A   4705(1)  	BCLR 		ASK_FLAG
   843  00024B   C2D5(2)  	CALL 		TMDATA_ASK
   844  00024C   1E0A(1)  	MOV 		A,DATA_OUT
   845  00024D   1F0B(1)  	MOV 		DATAH,A
   846  00024E   4F05(1)  	BSET 		ASK_FLAG
   847  00024F   C2D5(2)  	CALL 		TMDATA_ASK
   848  000250   1E0A(1)  	MOV 		A,DATA_OUT
   849  000251   1F0C(1)  	MOV 		DATAL,A		
   850  000252             ;//////////////////////DEBUG////////////////////
   851  000252   C2B3(2)  	CALL		I2C_END_TM
   852  000253   C333(2)  	CALL		DELAY_LONG
   853  000254   C2AD(2)  	CALL		I2C_START_TM
   854  000255             ;***********************************************
   855  000255   2D3C(1)  	MOV 		A,#0X3C
   856  000256   1F09(1)  	MOV 		DATA_IN,A
   857  000257   C2BB(2)  	CALL 		TMADDRESS_ASK
   858  000258             ;**************END*******************************
   859  000258             ;**************END*******************************
   860  000258   C2B3(2)  	CALL		I2C_END_TM
   861  000259   C32D(2)  	CALL		DELAY_SHORT
   862  00025A   61D2(1)  	B0BCLR		SDATA_IO
   863  00025B   2611(1+S)  	DECMS		COUNT
   864  00025C   825E(2)  	JMP			$+2
   865  00025D   8266(2)  	JMP			END_TM
   866  00025E   64D5(1)  	B0BCLR 		VTM_IO
   867  00025F   2D00(1)  	MOV			A,#0X00
   868  000260   070B(1+S)  	CMPRS		A,DATAH
   869  000261   8265(2)  	JMP			$+4
   870  000262   070C(1+S)  	CMPRS		A,DATAL
   871  000263   8265(2)  	JMP			$+2
   872  000264   8217(2)  	JMP			TM_I2C_WORK_LOOP
   873  000265   4906(1)  	BSET		READ_LED_FLAG
   874  000266             END_TM:
   875  000266   4506(1)  	BCLR		TM_I2C_EEROR
   876  000267   64D5(1)  	B0BCLR 		VTM_IO
   877  000268   61C2(1)  	B0BCLR		SDATA_CONT
   878  000269   60C2(1)  	B0BCLR		SCL_CONT
   879  00026A   C32D(2)  	CALL 		DELAY_SHORT
   880  00026B   2D00(1)  	MOV			A,#0X00
   881  00026C   070B(1+S)  	CMPRS		A,DATAH
   882  00026D   8273(2)  	JMP			EXIT_TM_I2C
   883  00026E   070C(1+S)  	CMPRS		A,DATAL
   884  00026F   8273(2)  	JMP			EXIT_TM_I2C
   885  000270   2DFF(1)  	MOV			A,#0XFF
   886  000271   1F0B(1)  	MOV			DATAH,A
   887  000272   1F0C(1)  	MOV			DATAL,A
   888  000273             EXIT_TM_I2C:
   889  000273   0E00(2)  	RET
   890  000274             ;*******************************************
   891  000274             ;***********************************************************
   892  000274             ;*********************************************************
   893  000274             GET_DATA_FROM_EE_FUN:
   894  000274   68C2(1)  	B0BSET		SCL_CONT
   895  000275   6DC2(1)  	B0BSET		SDA_CONT
   896  000276   6DD2(1)  	B0BSET		SDA_IO
   897  000277   68D2(1)  	B0BSET		SCL_IO
   898  000278   C32D(2)  	CALL		DELAY_SHORT
   899  000279   C2A0(2)  	CALL		I2C_START_EE
   900  00027A   2DA0(1)  	MOV			A,#EEW_ADD
   901  00027B   1F09(1)  	MOV			DATA_IN,A
   902  00027C   C2F1(2)  	CALL		EEADDRESS_ASK
   903  00027D   1E12(1)  	MOV			A,MAC_H
   904  00027E   1F09(1)  	MOV			DATA_IN,A
   905  00027F   C2F1(2)  	CALL		EEADDRESS_ASK
   906  000280   1E13(1)  	MOV			A,MAC_L
   907  000281   1F09(1)  	MOV			DATA_IN,A
   908  000282   C2F1(2)  	CALL		EEADDRESS_ASK
   909  000283   6DD2(1)  	B0BSET		SDA_IO
   910  000284   C32D(2)  	CALL		DELAY_SHORT
   911  000285   68D2(1)  	B0BSET		SCL_IO
   912  000286   C32D(2)  	CALL		DELAY_SHORT
   913  000287   C2A0(2)  	CALL		I2C_START_EE
   914  000288   C32D(2)  	CALL		DELAY_SHORT
   915  000289   2DA1(1)  	MOV			A,#EER_ADD
   916  00028A   1F09(1)  	MOV			DATA_IN,A
   917  00028B   C2F1(2)  	CALL		EEADDRESS_ASK
   918  00028C   65C2(1)  	B0BCLR		SDA_CONT
   919  00028D   4705(1)  	BCLR		ASK_FLAG
   920  00028E   C30B(2)  	CALL		EEDATA_ASK
   921  00028F   1E0A(1)  	MOV			A,DATA_OUT
   922  000290   1F0D(1)  	MOV			ADDRESSH,A
   923  000291   65C2(1)  	B0BCLR		SDA_CONT
   924  000292   C328(2)  	CALL		DELAY_MINI
   925  000293   4F05(1)  	BSET		ASK_FLAG
   926  000294   C30B(2)  	CALL		EEDATA_ASK
   927  000295   1E0A(1)  	MOV			A,DATA_OUT
   928  000296   1F0E(1)  	MOV			ADDRESSL,A
   929  000297   C2A6(2)  	CALL		I2C_END_EE
   930  000298             ;*************************************
   931  000298   C32D(2)  	CALL		DELAY_SHORT
   932  000299   60C2(1)  	B0BCLR		SCL_CONT
   933  00029A   65C2(1)  	B0BCLR		SDA_CONT
   934  00029B   0E00(2)  	RET
   935  00029C             ;************************************************
   936  00029C             I2C_EEROR:
   937  00029C             	;open interrupt
   938  00029C             	;SleepMode
   939  00029C   4605(1)  	BCLR	I2CERROR_FLAG
   940  00029D   54D5(1+S)  	BTS0	VTM_IO
   941  00029E   4D06(1)  	BSET	TM_I2C_EEROR
   942  00029F   0E00(2)  	RET
   943  0002A0             I2C_START_EE:
   944  0002A0   C328(2)  	CALL		DELAY_MINI
   945  0002A1   65D2(1)  	B0BCLR 		SDA_IO
   946  0002A2   C328(2)  	CALL 		DELAY_MINI
   947  0002A3   60D2(1)  	B0BCLR 		SCL_IO
   948  0002A4   C328(2)  	CALL 		DELAY_MINI
   949  0002A5   0E00(2)  	RET
   950  0002A6             I2C_END_EE:
   951  0002A6   65D2(1)  	B0BCLR 		SDA_IO
   952  0002A7   C328(2)  	CALL 		DELAY_MINI
   953  0002A8   68D2(1)  	B0BSET 		SCL_IO
   954  0002A9   C328(2)  	CALL 		DELAY_MINI
   955  0002AA   6DD2(1)  	B0BSET 		SDA_IO
   956  0002AB   C328(2)  	CALL		DELAY_MINI
   957  0002AC   0E00(2)  	RET
   958  0002AD             I2C_START_TM:
   959  0002AD   C328(2)  	CALL		DELAY_MINI
   960  0002AE   61D2(1)  	B0BCLR 		SDATA_IO
   961  0002AF   C328(2)  	CALL 		DELAY_MINI
   962  0002B0   60D2(1)  	B0BCLR 		SCL_IO
   963  0002B1   C328(2)  	CALL 		DELAY_MINI
   964  0002B2   0E00(2)  	RET
   965  0002B3             I2C_END_TM:
   966  0002B3   61D2(1)  	B0BCLR 		SDATA_IO
   967  0002B4   C328(2)  	CALL 		DELAY_MINI
   968  0002B5   60D2(1)  	B0BCLR		SCL_IO
   969  0002B6   C328(2)  	CALL		DELAY_MINI
   970  0002B7   69D2(1)  	B0BSET 		SDATA_IO
   971  0002B8   C328(2)  	CALL		DELAY_MINI
   972  0002B9   68D2(1)  	B0BSET 		SCL_IO
   973  0002BA   0E00(2)  	RET
   974  0002BB             TMADDRESS_ASK:
   975  0002BB   2D08(1)  	MOV 		A,#8
   976  0002BC   1F02(1)  	MOV 		TIMEOUT,A
   977  0002BD             TMADDRESS_LOOP:
   978  0002BD   5709(1+S)  	BTS0		DATA_IN.7
   979  0002BE   82C2(2)  	JMP 		MD_1
   980  0002BF   71D2(1+S)  	B0BTS0 		SDATA_IO
   981  0002C0   61D2(1)  	B0BCLR		SDATA_IO
   982  0002C1   82C4(2)  	JMP 		NEXT_1
   983  0002C2             MD_1:
   984  0002C2   79D2(1+S)  	B0BTS1 		SDATA_IO
   985  0002C3   69D2(1)  	B0BSET		SDATA_IO
   986  0002C4             NEXT_1:
   987  0002C4   C328(2)  	CALL		DELAY_MINI
   988  0002C5   68D2(1)  	B0BSET 		SCL_IO
   989  0002C6   C328(2)  	CALL		DELAY_MINI
   990  0002C7   0B09(1)  	RLCM 		DATA_IN
   991  0002C8   60D2(1)  	B0BCLR 		SCL_IO
   992  0002C9   2602(1+S)  	DECMS 		TIMEOUT
   993  0002CA   82BD(2)  	JMP 		TMADDRESS_LOOP
   994  0002CB             	
   995  0002CB   61C2(1)  	B0BCLR 		SDATA_CONT
   996  0002CC   C328(2)  	CALL		DELAY_MINI
   997  0002CD   68D2(1)  	B0BSET 		SCL_IO
   998  0002CE   C327(2)  	CALL 		CALL_DELAY
   999  0002CF   71D2(1+S)  	B0BTS0 		SDATA_IO
  1000  0002D0   C29C(2)  	CALL		I2C_EEROR
  1001  0002D1   C328(2)  	CALL		DELAY_MINI
  1002  0002D2   40D2(1)  	BCLR 		SCL_IO
  1003  0002D3   49C2(1)  	BSET 		SDATA_CONT
  1004  0002D4   0E00(2)  	RET
  1005  0002D5             ;**********************TM_READING_DATA********************************
  1006  0002D5             TMDATA_ASK:
  1007  0002D5   61C2(1)  	B0BCLR 		SDATA_CONT
  1008  0002D6   2D08(1)  	MOV 		A,#8
  1009  0002D7   1F02(1)  	MOV 		TIMEOUT,A
  1010  0002D8             TMDATA_LOOP:
  1011  0002D8   2D09(1)  	MOV 		A,#9
  1012  0002D9   1F03(1)  	MOV 		TLC0,A
  1013  0002DA   C328(2)  	CALL		DELAY_MINI
  1014  0002DB   48D2(1)  	BSET 		SCL_IO
  1015  0002DC   C327(2)  	CALL 		CALL_DELAY
  1016  0002DD   71D2(1+S)  	B0BTS0 		SDATA_IO
  1017  0002DE   480A(1)  	BSET 		DATA_OUT.0
  1018  0002DF   79D2(1+S)  	B0BTS1 		SDATA_IO
  1019  0002E0   400A(1)  	BCLR 		DATA_OUT.0
  1020  0002E1   0B0A(1)  	RLCM 		DATA_OUT
  1021  0002E2   C328(2)  	CALL		DELAY_MINI
  1022  0002E3   60D2(1)  	B0BCLR 		SCL_IO
  1023  0002E4   2602(1+S)  	DECMS 		TIMEOUT
  1024  0002E5   82D8(2)  	JMP 		TMDATA_LOOP
  1025  0002E6   69C2(1)  	B0BSET 		SDATA_CONT
  1026  0002E7   5705(1+S)  	BTS0 		ASK_FLAG
  1027  0002E8   69D2(1)  	B0BSET 		SDATA_IO
  1028  0002E9   5F05(1+S)  	BTS1 		ASK_FLAG
  1029  0002EA   61D2(1)  	B0BCLR 		SDATA_IO
  1030  0002EB   090A(1)  	RRCM 		DATA_OUT
  1031  0002EC   C328(2)  	CALL		DELAY_MINI
  1032  0002ED   48D2(1)  	BSET 		SCL_IO
  1033  0002EE   C328(2)  	CALL		DELAY_MINI
  1034  0002EF   40D2(1)  	BCLR		SCL_IO	
  1035  0002F0   0E00(2)  	RET
  1036  0002F1             ;******************************************************
  1037  0002F1             EEADDRESS_ASK:
  1038  0002F1   2D08(1)  	MOV 		A,#8
  1039  0002F2   1F02(1)  	MOV 		TIMEOUT,A
  1040  0002F3             EEADDRESS_LOOP:
  1041  0002F3   5709(1+S)  	BTS0		DATA_IN.7
  1042  0002F4   82F8(2)  	JMP 		EEMD_1
  1043  0002F5   75D2(1+S)  	B0BTS0 		SDA_IO
  1044  0002F6   65D2(1)  	B0BCLR		SDA_IO
  1045  0002F7   82FA(2)  	JMP 		EENEXT_1
  1046  0002F8             EEMD_1:
  1047  0002F8   7DD2(1+S)  	B0BTS1 		SDA_IO
  1048  0002F9   6DD2(1)  	B0BSET		SDA_IO
  1049  0002FA             EENEXT_1:
  1050  0002FA   C328(2)  	CALL		DELAY_MINI
  1051  0002FB   68D2(1)  	B0BSET 		SCL_IO
  1052  0002FC   C328(2)  	CALL		DELAY_MINI
  1053  0002FD   0B09(1)  	RLCM 		DATA_IN
  1054  0002FE   60D2(1)  	B0BCLR 		SCL_IO
  1055  0002FF   2602(1+S)  	DECMS 		TIMEOUT
  1056  000300   82F3(2)  	JMP 		EEADDRESS_LOOP
  1057  000301             	
  1058  000301   65C2(1)  	B0BCLR 		SDA_CONT
  1059  000302   C328(2)  	CALL		DELAY_MINI
  1060  000303   68D2(1)  	B0BSET 		SCL_IO
  1061  000304   C327(2)  	CALL 		CALL_DELAY
  1062  000305   75D2(1+S)  	B0BTS0 		SDA_IO
  1063  000306   C29C(2)  	CALL		I2C_EEROR
  1064  000307   C328(2)  	CALL		DELAY_MINI
  1065  000308   40D2(1)  	BCLR 		SCL_IO
  1066  000309   4DC2(1)  	BSET 		SDA_CONT
  1067  00030A   0E00(2)  	RET
  1068  00030B             ;****************************************
  1069  00030B             EEDATA_ASK:
  1070  00030B   65C2(1)  	B0BCLR 		SDA_CONT
  1071  00030C   2D08(1)  	MOV 		A,#8
  1072  00030D   1F02(1)  	MOV 		TIMEOUT,A
  1073  00030E             EEDATA_LOOP:
  1074  00030E   2D09(1)  	MOV 		A,#9
  1075  00030F   1F03(1)  	MOV 		TLC0,A
  1076  000310   C328(2)  	CALL		DELAY_MINI
  1077  000311   48D2(1)  	BSET 		SCL_IO
  1078  000312   C327(2)  	CALL 		CALL_DELAY
  1079  000313   75D2(1+S)  	B0BTS0 		SDA_IO
  1080  000314   480A(1)  	BSET 		DATA_OUT.0
  1081  000315   7DD2(1+S)  	B0BTS1 		SDA_IO
  1082  000316   400A(1)  	BCLR 		DATA_OUT.0
  1083  000317   0B0A(1)  	RLCM 		DATA_OUT
  1084  000318   C328(2)  	CALL		DELAY_MINI
  1085  000319   60D2(1)  	B0BCLR 		SCL_IO
  1086  00031A   2602(1+S)  	DECMS 		TIMEOUT
  1087  00031B   830E(2)  	JMP 		EEDATA_LOOP
  1088  00031C             	
  1089  00031C   6DC2(1)  	B0BSET 		SDA_CONT
  1090  00031D   5705(1+S)  	BTS0 		ASK_FLAG
  1091  00031E   6DD2(1)  	B0BSET 		SDA_IO
  1092  00031F   5F05(1+S)  	BTS1 		ASK_FLAG
  1093  000320   65D2(1)  	B0BCLR 		SDA_IO
  1094  000321   090A(1)  	RRCM 		DATA_OUT
  1095  000322   C328(2)  	CALL		DELAY_MINI
  1096  000323   48D2(1)  	BSET 		SCL_IO
  1097  000324   C328(2)  	CALL		DELAY_MINI
  1098  000325   40D2(1)  	BCLR		SCL_IO	
  1099  000326   0E00(2)  	RET
  1100  000327             ;*********************delay*****************
  1101  000327             CALL_DELAY:
  1102  000327   0E00(2)  	RET
  1103  000328             DELAY_MINI:;13US
  1104  000328   2D05(1)  	MOV		A,#0X05
  1105  000329   1F00(1)  	MOV		DELAYTIME1,A
  1106  00032A             DELAY0:
  1107  00032A   2600(1+S)  	DECMS	DELAYTIME1
  1108  00032B   832A(2)  	JMP		DELAY0
  1109  00032C   0E00(2)  	RET
  1110  00032D             	
  1111  00032D             DELAY_SHORT:		;50US FOR 0.5US/INSTRUCTION
  1112  00032D   2D63(1)  	MOV		A,#0X63
  1113  00032E   1F00(1)  	MOV		DELAYTIME1,A
  1114  00032F             DELAY1:
  1115  00032F   0000(1)  	NOP
  1116  000330   2600(1+S)  	DECMS	DELAYTIME1
  1117  000331   832F(2)  	JMP		DELAY1
  1118  000332   0E00(2)  	RET
  1119  000333             DELAY_LONG:	;>=5MS
  1120  000333             ;WAIT_FOR_A_LONG_WHILE
  1121  000333   2D0A(1)  	MOV		A,#0X0A
  1122  000334   2F00(1)  	B0MOV	DELAYTIME1,A
  1123  000335             DELAY2_1:
  1124  000335   2DC7(1)  	MOV		A,#0XC7
  1125  000336   1F01(1)  	MOV		DELAYTIME2,A
  1126  000337             DELAY2_2:
  1127  000337   0000(1)  	NOP
  1128  000338   2601(1+S)  	DECMS	DELAYTIME2
  1129  000339   8337(2)  	JMP		DELAY2_2	
  1130  00033A   2600(1+S)  	DECMS	DELAYTIME1
  1131  00033B   8335(2)  	JMP		DELAY2_1
  1132  00033C   0E00(2)  	RET		
  1133  00033D             DELAY_LED:		;0.2S
  1134  00033D             ;WAIT_FOR_DEEP_DARK_FANTASY
  1135  00033D   2DFF(1)  	MOV		A,#0XFF
  1136  00033E   1F01(1)  	MOV		DELAYTIME2,A
  1137  00033F             DELAY3_1:
  1138  00033F   2DFF(1)  	MOV		A,#0XFF
  1139  000340   1F00(1)  	MOV		DELAYTIME1,A
  1140  000341             DELAY3_2:
  1141  000341   0000(1)  	NOP
  1142  000342   0000(1)  	NOP
  1143  000343   2600(1+S)  	DECMS		DELAYTIME1
  1144  000344   8341(2)  	JMP			DELAY3_2
  1145  000345   2601(1+S)  	DECMS		DELAYTIME2
  1146  000346   833F(2)  	JMP			DELAY3_1
  1147  000347   0E00(2)  	RET
  1148  000348             OPEN_TC0_INT_FUN:
  1149  000348   6BDA(1)  	B0BSET	FTC0CKS	;	OUTSIDE INPUT ACCIDENT
  1150  000349   6ADA(1)  	B0BSET	FALOAD0 ;
  1151  00034A   2DFD(1)  	MOV		A,#0XFD
  1152  00034B   2FCD(1)  	B0MOV	TC0R,A
  1153  00034C   2FDB(1)  	B0MOV	TC0C,A
  1154  00034D   65C8(1)  	B0BCLR	FTC0IRQ
  1155  00034E   6DC9(1)  	B0BSET	FTC0IEN
  1156  00034F   6FDA(1)  	B0BSET	FTC0ENB
  1157  000350   0E00(2)  	RET
  1158  000351             SYS_INIT_FUN:
  1159  000351   2D2D(1)  	MOV			A,#0X2D
  1160  000352   2FC2(1)  	B0MOV		P2M,A
  1161  000353   2D35(1)  	MOV			A,#0X35
  1162  000354   2FD2(1)  	B0MOV		P2,A
  1163  000355             	;up resistor for p2.4
  1164  000355   2D10(1)  	MOV			A,#0X10
  1165  000356   2FE2(1)  	B0MOV		P2UR,A
  1166  000357   2D01(1)  	MOV			A,#0X01
  1167  000358   2FC1(1)  	B0MOV		P1M,A
  1168  000359   2BD1(1)  	CLR			P1
  1169  00035A   68B8(1)  	B0BSET		VSR_CONT
  1170  00035B   60D0(1)  	B0BCLR		VSR_IO
  1171  00035C   68C1(1)  	B0BSET		S_VDD_VCC_CONT
  1172  00035D   60D1(1)  	B0BCLR		S_VDD_VCC_IO
  1173  00035E   6CC5(1)  	B0BSET		VTM_CONT
  1174  00035F   64D5(1)  	B0BCLR		VTM_IO
  1175  000360   2D03(1)  	MOV			A,#0X03
  1176  000361   1F0F(1)  	MOV			CRCT1,A
  1177  000362   C32D(2)  	CALL		DELAY_SHORT
  1178  000363   54D2(1+S)  	BTS0		BLEF
  1179  000364   8368(2)  	JMP			SYS_INIT_LED
  1180  000365   4E06(1)  	BSET		BLE_FLAG
  1181  000366   2D02(1)  	MOV			A,#0X02
  1182  000367   1F0F(1)  	MOV			CRCT1,A
  1183  000368             SYS_INIT_LED:
  1184  000368   62D2(1)  	B0BCLR		CLED_IO
  1185  000369   C33D(2)  	CALL		DELAY_LED	
  1186  00036A   6AD2(1)  	B0BSET		CLED_IO
  1187  00036B   C33D(2)  	CALL		DELAY_LED
  1188  00036C   260F(1+S)  	DECMS		CRCT1
  1189  00036D   8368(2)  	JMP			SYS_INIT_LED
  1190  00036E             ;************T0_INIT_START************************************
  1191  00036E   2D00(1)  	MOV			A,#0X00
  1192  00036F   2FD8(1)  	B0MOV		T0M,A	
  1193  000370   68D8(1)  	B0BSET		FT0TB	; T0 = Fcpu/256,PERIOD TIME IS 2S
  1194  000371   2BD9(1)  	CLR			T0C
  1195  000372   64C8(1)  	B0BCLR		FT0IRQ
  1196  000373   6CC9(1)  	B0BSET		FT0IEN
  1197  000374   6FD8(1)  	B0BSET		FT0ENB
  1198  000375             ;*****************TC0_INIT_START*****************
  1199  000375   2BDA(1)  	CLR			TC0M
  1200  000376   2BDB(1)  	CLR			TC0C
  1201  000377   65C8(1)  	B0BCLR		FTC0IRQ
  1202  000378   65C9(1)  	B0BCLR		FTC0IEN
  1203  000379   67DA(1)  	B0BCLR		FTC0ENB
  1204  00037A             ;************************OPEN P1.1WEEK UP FUNCTION*********************
  1205  00037A   2D02(1)  	MOV			A,#0X02
  1206  00037B   2FC0(1)  	B0MOV		P1W,A
  1207  00037C   C328(2)  	CALL		DELAY_MINI
  1208  00037D   0E00(2)  	RET
  1209  00037E             ;//////////////////////////////////////////////////
  1210  00037E             SET_EE_TM_FUN:
  1211  00037E   65C2(1)  	B0BCLR		SDA_CONT
  1212  00037F   64C5(1)  	B0BCLR		VTM_CONT
  1213  000380   60C2(1)  	B0BCLR		SCL_CONT
  1214  000381   61C2(1)  	B0BCLR		SDATA_CONT
  1215  000382   68D0(1)  	B0BSET		VSR_IO
  1216  000383   6BD2(1)  	B0BSET		S_TM_EE_IO
  1217  000384   4A05(1)  	BSET		TM_EE_FLAG
  1218  000385   4406(1)  	BCLR	NOT_QUICK_MODE_FLAG
  1219  000386   0E00(2)  	RET
  1220  000387             ;////////////////////////////////////////
  1221  000387             ;////////////SET LOW POWER
  1222  000387             SET_LOW_POWER_FUN:
  1223  000387             ;****************************************
  1224  000387   64C5(1)  	B0BCLR		VTM_CONT
  1225  000388   63D2(1)  	B0BCLR		S_TM_EE_IO
  1226  000389   60D0(1)  	B0BCLR		VSR_IO
  1227  00038A   4205(1)  	BCLR		TM_EE_FLAG
  1228  00038B   0E00(2)  	RET
  1229  00038C             ;/////////////////////////////////////////	
  1230  00038C             ;*******************************************
  1231  00038C             	ENDP
